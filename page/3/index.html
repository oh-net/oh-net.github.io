<!DOCTYPE html>













<html class="theme-next gemini" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.6.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.6.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.6.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.6.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.6.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.6.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="$$ Welcome $$">
<meta property="og:type" content="website">
<meta property="og:title" content="Technician">
<meta property="og:url" content="https://hero.triple.net.cn/page/3/index.html">
<meta property="og:site_name" content="Technician">
<meta property="og:description" content="$$ Welcome $$">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Technician">
<meta name="twitter:description" content="$$ Welcome $$">






  <link rel="canonical" href="https://hero.triple.net.cn/page/3/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Technician</title>
  











  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Technician</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">Yet another note</p>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-sitemap">

    
    
    
      
    

    

    <a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>站点地图</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://hero.triple.net.cn/2018/03/28/linux-e4-b8-8b-e5-ae-89-e8-a3-85eclipse/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="$$ Welcome $$">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Technician">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/03/28/linux-e4-b8-8b-e5-ae-89-e8-a3-85eclipse/" class="post-title-link" itemprop="https://hero.triple.net.cn/page/3/index.html">Linux下安装Eclipse</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-03-28 18:46:23" itemprop="dateCreated datePublished" datetime="2018-03-28T18:46:23+08:00">2018-03-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-12 17:20:50" itemprop="dateModified" datetime="2018-12-12T17:20:50+08:00">2018-12-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/操作系统/" itemprop="url" rel="index"><span itemprop="name">操作系统</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Java环境"><a href="#Java环境" class="headerlink" title="Java环境"></a>Java环境</h2><p>若要在Linux下面安装Oracle 的Java， 参见本博另一篇文章：<a href="https://tech.msla.top/?p=762" target="_blank" rel="noopener">Linux 下面配置 Oracle JDK</a></p>
<h2 id="下载："><a href="#下载：" class="headerlink" title="下载："></a>下载：</h2><p>官方地址： <a href="https://www.eclipse.org/downloads/eclipse-packages/?osType=linux&amp;release=undefined" target="_blank" rel="noopener">https://www.eclipse.org/downloads/eclipse-packages/?osType=linux&amp;release=undefined</a> 国内维护： happiz.msla.qiniu.cdn.msla.top/eclipse-java-oxygen-3-linux-gtk-x86_64.tar.gz</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p># 以下操作均已root账户执行，或者具有sudo权限的用户按需要在命令前面加 sudo</p>
<pre><code># 将文件复制到安装路径下/usr/local/，并解压，最后执行：
cp eclipse-java-luna-SR2-linux-gtk-x86_64.tar.gz /usr/local/
# 解压
tar -zxvf eclipse-java-luna-SR2-linux-gtk-x86_64.tar.gz
cd eclipse
# 命令行中启动Eclipse
./eclipse
</code></pre><h2 id="制作快捷方式"><a href="#制作快捷方式" class="headerlink" title="制作快捷方式"></a>制作快捷方式</h2><p># 以下操作均以root账户执行，或者具有sudo权限的用户按需要在命令前面加 sudo</p>
<pre><code>vi Eclipse.desktop
# 在文件中输入下面的内容
[Desktop Entry]
Name=Eclipse
Exec=/usr/local/eclipse/eclipse -desktop
Icon=/usr/local/eclipse/plugins/org.eclipse.platform_xxxx.xxx.xxx/eclipse64.png
Type=Application
Comment=Run eclipse
Path=
Terminal=false
StartupNotify=false

# 复制到桌面中
mv Eclipse.desktop /home/user123/Desktop/
</code></pre><h2 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h2><p>有可能会提示“Eclipse 没有标记为可信任” 的问题，右键查看时，已设定为可执行。 解决方法： 使用root帐号将这个文件所有者设置为执行的用户：</p>
<pre><code>su
chown user123:user123 Eclipse.desktop
</code></pre>
          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://hero.triple.net.cn/2018/02/28/important-math-in-program/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="$$ Welcome $$">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Technician">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/28/important-math-in-program/" class="post-title-link" itemprop="https://hero.triple.net.cn/page/3/index.html">作为程序员的你，何时意识到数学的重要性?</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-28 18:46:02" itemprop="dateCreated datePublished" datetime="2018-02-28T18:46:02+08:00">2018-02-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-18 12:25:14" itemprop="dateModified" datetime="2018-12-18T12:25:14+08:00">2018-12-18</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/技术分类/" itemprop="url" rel="index"><span itemprop="name">技术分类</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>我印象很深的一个例子，是当年学WordPress的时候，接触到一个函数 <a href="core.trac.wordpress.org/browser/tags/4.8/src/wp-includes/pluggable.php#L1846">wp_nonce_tick</a> 有时候HTTP请求需要在特定周期过后失效，也就是时间敏感的请求签名，这是后台自我保护的一种机制。 </p>
<blockquote>
<p>怎么样让一个请求在一定时间后过期呢？</p>
</blockquote>
<p>按照web后台程序员习惯的方法，是在数据库或者session里存一个值，相应请求到达后端的时候就去检查这个值是否还匹配。</p>
<p>但是只是存放一个值并不能关联到时间，所有就要设计相应的机制去 <code>poll/update</code> 这个值。如果这样搞，开销会很大</p>
<p>Nonce的基本原理就是一个算式：</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    ceil(time() / ( life / 2 ))</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">你有兴趣可以打开浏览器控制台用Javascript来试试，比如一分钟内有效期的Nonce</span><br></pre></td></tr></table></figure></div>
<pre><code>Math.ceil(Math.ceil(new Date().getTime() / 1000) / (60 / 2))
</code></pre><p><code>`</code> </p>
<p>用这个值来给请求签名，服务器端只需要计算一个同周期的Nonce，看看两者是否相等就可以判断请求是否仍然有效。 </p>
<p>不用存什么中间值，不用poll，只是简单的数学规律，谈不上多高深，但你知道了这个工具以后，会觉得太强大r、太美、数学家真牛逼</p>
<p>加密学上有很多让不懂数学的人，懂了以后觉得毛骨悚然的例子，你可以买本书来看看，我数学差，就不混充很懂了。</p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://hero.triple.net.cn/2018/02/14/e5-90-8c-e6-97-b6-e4-bd-bf-e7-94-a8-e6-9c-89-e7-ba-bf-e7-bd-91-e4-b8-8a-e5-86-85-e7-bd-91-e3-80-81-e6-97-a0-e7-ba-bf-e7-bd-91-e4-b8-8a-e5-a4-96-e7-bd-91/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="$$ Welcome $$">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Technician">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/14/e5-90-8c-e6-97-b6-e4-bd-bf-e7-94-a8-e6-9c-89-e7-ba-bf-e7-bd-91-e4-b8-8a-e5-86-85-e7-bd-91-e3-80-81-e6-97-a0-e7-ba-bf-e7-bd-91-e4-b8-8a-e5-a4-96-e7-bd-91/" class="post-title-link" itemprop="https://hero.triple.net.cn/page/3/index.html">同时使用有线网上内网、无线网上外网</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-14 11:37:01" itemprop="dateCreated datePublished" datetime="2018-02-14T11:37:01+08:00">2018-02-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-12 17:08:58" itemprop="dateModified" datetime="2018-12-12T17:08:58+08:00">2018-12-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/互联网/" itemprop="url" rel="index"><span itemprop="name">互联网</span></a></span>

                
                
              
            </span>
          

          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="方法一、"><a href="#方法一、" class="headerlink" title="方法一、"></a>方法一、</h3><p>利用有线访问局域网数据库等，用无线网络访问外网，这里提供一种方法可以实现，可编写bat文件，并在cmd中执行：</p>
<pre><code>route delete 0.0.0.0

route add 0.0.0.0 mask 0.0.0.0 172.20.1.254

route add 172.20.36.0 mask 255.255.255.0 172.20.36.254
</code></pre><p>解释一下： 其中<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><figcaption><span>针对上述情况，实际应用中，遇到windows 7与windows xp两者不一样，windows 7中，除了上述命令外，在TCP/IP配置中，无线外网设置为自动获取，内网配置为内网IP，子网掩码，网关。 widows xp中，除了上述命令外，在TCP/IP配置中，无线设置为手动输入IP，子网掩码，且网关留空，不填，内网配置为内网IP，子网掩码，网关。  </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 方法二、</span><br><span class="line"></span><br><span class="line">  例1 我的笔记本用无线 网卡联互联网，同时局域网使用的是有线 连接（网段 132.147.X.X，不提供接入Internet服务），同时提供无线 网络连接供客户使用（网段192.168.1.X，可连接互联网）。 如果同时连接有线 网卡和 无线 网卡，因为有线 网卡的优先级较高，故仅有线 局域网能正常工作，无线 网卡可连接但却无法传送数据。要改变这种情况，需要对笔记本本地路由设置做出修改：访问132.147.X.X的请求均有有线 网卡处理，访问其它网络的则由无线 网卡处理。 具体设置步骤如下： 1. 设置无线 网卡为默认路由网关：无线 网络连接属性—Internet协议（TCP/IP）-属性-高级，手动输入无线 路由网关，我这里的是132.147.X.X，跃点数为“1”， 是最高优先级。到了这一步，如果有线 连接，无线 连接同时存在的话，所有的数据都是经由无线 网卡处理的。 2. 设置排除信息，把132.147.X.X路段的网址连接请求交由优先网卡处理：在命令行输入以下命令</span><br><span class="line"></span><br><span class="line">    route -p add 132.147.0.0 mask 255.255.0.0 132.147.160.1</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">其中132.147.0.0是本地局域网网段，132.147.160.1是本机所处子网段的默认网关，需要根据具体情况填写。经过以上设置，在访问本地网段的时候均由有线 网卡处理，访问互联网的时候可交由无线 网卡处理，就不会产生冲突了。</span><br><span class="line"></span><br><span class="line">**注意****: ****这里的****172.16.x.x ****和****192.168.1.X ****和你的局域网环境有关**,可以命令行下ipconfig /all 查看</span><br><span class="line"></span><br><span class="line">例2</span><br><span class="line"></span><br><span class="line">### 局域网有线连接（网段172.16.X.X，不提供接入internet服务），WIFI连接（网段192.168.1.X，可连接互联网)。</span><br><span class="line"></span><br><span class="line">如 果同时连接有线网卡和无线网卡，因为有线网卡的优先级较高，故仅有线局域网能正常工作，无线网卡可连接但却无法传送数据。要改变这种情况，需要对笔记本本 地路由设置做出修改：访问172.16.X.X的请求均有有线网卡处理，访问其它网络的则由无线网卡处理。设置步骤如下： 1》 设置无线网卡为默认路由网关：无线网络连接属性—Internet协议(TCP/IP)-属性-高级，手动输入无线路由网关，我这里的是 192.168.1.1，跃点数为“1”，是最高优先级。到了这一步，如果有线连接，无线连接同时存在的话，所有的数据都是经由无线网卡处理的。 2》设置排除信息，把172.16.X.X路段的网址连接请求交由优先网卡处理：在命令行输入以下命令</span><br><span class="line"></span><br><span class="line">    route -p add 172.16.0.0 mask 255.255.0.0 172.16.6.1</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">其中172.16.0.0是本地局域网网段，172.16.6.1是本机所处子网段的默认网关，需要根据具体情况填写。 经过以上设置，在访问本地网段的时候均由有线网卡处理，访问互联网的时候可交由无线网卡处理，就不会产生冲突了。</span><br><span class="line"></span><br><span class="line">### 其它信息(来自网络)</span><br><span class="line"></span><br><span class="line">不少公司的网管试图解决双网卡问题，下面我就给大家详细的讲解一下双网卡同时使用的方法，这样即可保障内网的安全，又能解决电脑访问外网的问题，一举两得。希望大家喜欢。</span><br><span class="line"></span><br><span class="line">首先你的机器需要有两块网卡，分别接到两台交换机上,</span><br><span class="line"></span><br><span class="line">internet地址：192.168.1.8，子网掩码：255.255.255.0，网关：192.168.1.1</span><br><span class="line"></span><br><span class="line">内部网地址：172.23.1.8，子网掩码：255.255.255.0，网关：172.23.1.1</span><br><span class="line"></span><br><span class="line">如果按正常的设置方法设置每块网卡的ip地址和网关，再cmd下使用route print查看时会看到</span><br><span class="line"></span><br><span class="line">Network Destination Netmask Gateway Interface Metric</span><br><span class="line"></span><br><span class="line">0.0.0.0 0.0.0.0 192.168.1.1 192.168.1.8</span><br><span class="line"></span><br><span class="line">0.0.0.0 0.0.0.0 172.23.1.1 172.23.1.8</span><br><span class="line"></span><br><span class="line">即指向0.0.0.0的有两个网关，这样就会出现路由冲突，两个网络都不能访问。</span><br><span class="line"></span><br><span class="line">如何实现同时访问两个网络？那要用到route命令</span><br><span class="line"></span><br><span class="line">第一步：route delete 0.0.0.0     &quot;删除所有0.0.0.0的路由&quot;</span><br><span class="line"></span><br><span class="line">第二步：route add 0.0.0.0 mask 0.0.0.0 192.168.1.1     &quot;添加0.0.0.0网络路由&quot;这个是主要的,意思就是你可以上外网.</span><br><span class="line"></span><br><span class="line">第三步：route add 172.23.0.0 mask 255.0.0.0 172.23.1.1    &quot;添加172.23.0.0网络路由&quot;，注意mask为255.0.0.0   ，而不是255.255.255.0 ，这样内部的多网段才可用。</span><br><span class="line"></span><br><span class="line">这时就可以同时访问两个网络了，但碰到一个问题，使用上述命令添加的路由在系统重新启动后会自动丢失，怎样保存现有的路由表呢？</span><br><span class="line"></span><br><span class="line">route add -p 添加静态路由，即重启后，路由不会丢失。注意使用前要在tcp/ip设置里去掉接在企业内部网的网卡的网关</span><br><span class="line"></span><br><span class="line">------------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">一些单位将内网和外网分开了。痛苦啊，偶单位就是如此。boss当然是基于安全性考虑了，可是没有笔记本的怎么办？又要办公，有得上网。没办法，发扬DIY精神偷偷装一块网卡，让聊天与工作同在。让你的主机内外兼顾。这是我在网上找到的，谢谢作者了。方法如下： 1.设置其中接internet的网卡的网关为10.0.0.1，启用后就是默认网关 --注：这是对应外网的网卡，按照你们单位外网的ip分配情况，在TCP/IP属性中配置好 ip、掩码、DNS</span><br><span class="line"></span><br><span class="line">2.将连接单位内部网的网卡IP配好后，设网关设置为空（即不设网关），启用后，此时内网无法通过网关路由</span><br><span class="line"></span><br><span class="line">3.进入CMD，运行：route -p add 192.0.0.0 mask 255.0.0.0 192.168.0.1 metric 1</span><br><span class="line"></span><br><span class="line">--注：意思是将192*的IP包的路由网关设为192.168.0.1 ，-P 参数代表永久写入路由表，建议先不加此参数，实践通过后在写上去</span><br><span class="line"></span><br><span class="line">4. OK！同时启用两个网卡，两个网关可以同时起作用了，两个子网也可以同时访问了，关机重启后也不用重设！</span><br><span class="line"></span><br><span class="line">``</span><br></pre></td></tr></table></figure></div></p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://hero.triple.net.cn/2018/02/06/php-e6-a1-86-e6-9e-b6-e4-b9-8b-e4-ba-89/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="$$ Welcome $$">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Technician">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/06/php-e6-a1-86-e6-9e-b6-e4-b9-8b-e4-ba-89/" class="post-title-link" itemprop="https://hero.triple.net.cn/page/3/index.html">PHP 框架之争</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-06 10:53:07" itemprop="dateCreated datePublished" datetime="2018-02-06T10:53:07+08:00">2018-02-06</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-12 17:22:01" itemprop="dateModified" datetime="2018-12-12T17:22:01+08:00">2018-12-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/技术分类/" itemprop="url" rel="index"><span itemprop="name">技术分类</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原文来自V站，帖子在这里： <a href="https://www.v2ex.com/t/428592" target="_blank" rel="noopener">https://www.v2ex.com/t/428592</a> 有很多人做了我们没时间&amp;没能力做到的事情，减少了自己亲历亲为的代价，先表示感谢， 我把个人认为有用的copy下来： Yii2，Yaf，CI。大型用 Yii2，中小型 CI，要效率，Yaf。 天天说 Laravel 很重很重，但你有没有用过 Laravel 的精简版 Lumen ？ 以速度著称的 Lumen 都不知道要甩其他框架几条街，用做 API 和前后端分离的最佳框架之一。 当哪天你不想用 Lumen，还可以无痛升级到 Laravel —— Yii 增删查改不够方便（相比别的）； Laravel 乱七八糟的东西太多，增加不必要的折腾。谁简单实用就用谁吧，安全问题框架解决不了。 —— Laravel 在我看来有几点无法接受 1. 都说 Laravel 模仿 Rails,但是 Rails 的哲学里”约定优于配置”却没抄过来,起码路由没有. 没有自动路由,每加一个 action 就要去配置文件里写一次,简直恶心死了. 最恶心的是你接手别人项目时候,路由还有几种风格的,分析时在 html 或者 js 里找到个接口,接着想找 php 的具体实现,必须先去看路由的配置文件 2. 全局函数以及 Facade 众多语言 /框架都是先引入,再使用,到 Laravel 这里就不是了 从文档上下文来看,并没有显式引入某个函数 /类,为什么从天而降给了个函数 /类给我用,你到底还偷偷引入了多少东西? 3.文档 文档太简陋了,一堆细节没说,具体实现太绕,经常要看源码 4.view 层 PHP 本身就是个强大的模板语言,非要再往上加个模板引擎,这就算了 不能忍的是 view 文件的路径分隔居然是用”.”而不是”/“ 当出现了像 view(‘activities.index’)这样的代码,我要去找具体的 view 文件时,就要手工把”.”转换成”/“,然后在编辑器 /IDE 里跳过去 如果是 view(‘activities/index’)的话,我只需要复制 activities/index 出来,然后使用编辑器 /IDE 的任意文件跳转功能,瞬间就转过去了 如果你非要说装个插件就能解决的话,当我没说过这一条 5.性能 大部分 Laravel 的性能优化文章都是千篇一律,无非就是升 php7,开 opcache,关闭 debug,开路由 /配置缓存,生成 composer 安装的所有依赖的 class map 废话,这些基础谁不会 在没做上述优化之前,我压测 hello world 的结果,qps 只有 5~7 在做完上述这些之后,qps 到了 13~15,哇,性能是原来的 2 倍,开心吗 这个 qps,我按住 F5 都能把网站给刷爆 同样的环境下,也做了上述的优化后,CodeIgniter,Yii,ThinkPHP 这几个框架的 qps 都在 200~400 之间 别说加了 db 操作之后大家都差不多,不少页面能命中缓存的情况下,io 的耗时比 Laravel 的耗时都要低 6.其他 Laravel 自带的队列 去年帮别人改代码时碰到的,消息是经过 PHP 的序列化放进队列的,可改造性差 队列为空就退出进程,官方还教你用 supervisor 去守护,喵喵喵? 神经病一样的存在 Laravel 的诞生并没有解决太多的痛点,或者说他解决的问题在我这里根本就不痛,还带我来了更多的坑,换我在 PHP 框架上选型我也选 Yii Yii 文档丰富,细节到位,安全指南也够用,没那么多花哨的概念,代码规范又符合直觉,层次清晰,性能虽然没有常驻内存的框架好,但也够用,只需要专心处理业务就是 而且 PHP 不适合玩常驻内存,毕竟没有多少对 GC 的讨论,官方也没有什么指南给你去调优,因为本身设计就是请求完就销毁的 玩异步的话,除了 Swoole 框架有异步文件 IO 函数,其它框架都没有,除非自己用多线程模拟,否则一处阻塞处处阻塞,可选型方案太少,还不如换语言 —— 9 年前搞过 yii 还把 zend 项目无痛转成了 yii 现在它自带后台了吗 像 laravel voyager 现在鄙人再也不关注性能 只在乎开发速度 和现场的东西 —— yii2-starter-kit 自带后台, rest-api， 通一遍之后，开发很快 —— 我现在比较关注设计理念，工作用 CakePHP,自己写东西用 Symfony ；看过 laravel 与 yii，只能说 laravel 的优雅我没有 get 到 —— 我觉得框架选择，主要还是熟悉度，一个非常熟悉踩过很多坑的框架，和一个熟悉但是没怎么用过的框架，谁都知道选哪个吧，前者可以是 Yii 可以是 Laravel，取决于选择框架的人 —— CodeIgniter 刚工作时深度使用,当时那家公司用 2 台服务器撑起了千万级 PV 的业务 ThinkJS 作为个人 Node 项目的 api 接口 Web 框架看多了,会发现它们基本都是大同小异,无论是流程上还是功能上,到后面无非就是找一些符合自己理念 /哲学 /信仰的工具而已 还是多研究些架构更实在 —— Yii 相对于 Laraval，类似自助餐与方便面的关系，从健康（相对于方便面）、分量、口味、厌倦周期等角度来说，推荐 Yii，从就餐时间角度来说，推荐 Laraval ——</p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://hero.triple.net.cn/2018/01/23/e9-80-9a-e8-bf-87sql-e7-b4-af-e5-8a-a0-e6-95-b0-e6-8d-ae/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="$$ Welcome $$">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Technician">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/01/23/e9-80-9a-e8-bf-87sql-e7-b4-af-e5-8a-a0-e6-95-b0-e6-8d-ae/" class="post-title-link" itemprop="https://hero.triple.net.cn/page/3/index.html">通过SQL累加数据</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-01-23 13:09:04" itemprop="dateCreated datePublished" datetime="2018-01-23T13:09:04+08:00">2018-01-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-12 17:13:43" itemprop="dateModified" datetime="2018-12-12T17:13:43+08:00">2018-12-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/数据库/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h3><p>通过SQL累加数据。已知有列A（id），B（coin），C（direction）， 规则： 1. 当 c = 1 时，查询的结果， 新列D == B（coin），否则 新列E == B（coin） 2. 然后再根据C（direction）的值，使用相同的规则(#1)，累加B（coin），生成新列F 先看表结构：</p>
<pre><code>CREATE TABLE `test1` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `coin` int(11) NOT NULL,
  `direction` int(11) NOT NULL,
  PRIMARY KEY (`id`)
);
-- 测试数据
INSERT INTO `test1` VALUES (&apos;1&apos;, &apos;1&apos;, &apos;1&apos;);
INSERT INTO `test1` VALUES (&apos;2&apos;, &apos;22&apos;, &apos;0&apos;);
INSERT INTO `test1` VALUES (&apos;3&apos;, &apos;33&apos;, &apos;1&apos;);
INSERT INTO `test1` VALUES (&apos;4&apos;, &apos;4&apos;, &apos;0&apos;);
INSERT INTO `test1` VALUES (&apos;5&apos;, &apos;4&apos;, &apos;1&apos;);
INSERT INTO `test1` VALUES (&apos;6&apos;, &apos;99&apos;, &apos;0&apos;);
INSERT INTO `test1` VALUES (&apos;7&apos;, &apos;7&apos;, &apos;0&apos;);
INSERT INTO `test1` VALUES (&apos;8&apos;, &apos;8&apos;, &apos;0&apos;);
INSERT INTO `test1` VALUES (&apos;9&apos;, &apos;23&apos;, &apos;1&apos;);
INSERT INTO `test1` VALUES (&apos;10&apos;, &apos;543&apos;, &apos;0&apos;);
</code></pre><p>--- 要实现的效果： : <img src="https://tech.msla.top/wp-content/uploads/2018/04/sql_result.png" alt="通过SQL累加要实现的效果"> 也就是说：</p>
<ol>
<li>D=增加=B</li>
<li>E=减少=B</li>
<li>F=余额累加数</li>
</ol>
<p>----</p>
<h3 id="方案一"><a href="#方案一" class="headerlink" title="方案一"></a>方案一</h3><pre><code>SET @csum := 0;
SELECT
    a.id,
    a.coin,
    a.direction AS &apos;B(direction)&apos;,
    (
        CASE a.direction
        WHEN 1 THEN
            a.coin
        ELSE
            &apos; &apos;
        END
    ) AS D,
    (
        CASE a.direction
        WHEN 0 THEN
            a.coin
        ELSE
            &apos; &apos;
        END
    ) AS &apos;E&apos;,
    (
        @csum := @csum + (
            a.coin * (
                CASE a.direction
                WHEN 1 THEN
                    1
                ELSE
                    - 1
                END
            )
        )
    ) AS &apos;F&apos;
FROM
    test1 a
GROUP BY
    a.id,
    a.coin,
    a.direction,
    D,
    E
</code></pre><h3 id="方案二"><a href="#方案二" class="headerlink" title="方案二"></a>方案二</h3><pre><code>SELECT
    a.id,
    a.coin,
    a.direction AS &apos;B(direction)&apos;,
    (
        CASE a.direction
        WHEN 1 THEN
            a.coin
        ELSE
            &apos; &apos;
        END
    ) AS D,
    (
        CASE a.direction
        WHEN 0 THEN
            a.coin
        ELSE
            &apos; &apos;
        END
    ) AS &apos;E&apos;,
    (
        ifnull(
            (
                SELECT
                    SUM(b.coin)
                FROM
                    test1 b
                WHERE
                    b.id &lt;= a.id
                AND b.direction = 1
            ),
            0
        ) - ifnull(
            (
                SELECT
                    SUM(b.coin)
                FROM
                    test1 b
                WHERE
                    b.id &lt;= a.id
                AND b.direction = 0
            ),
            0
        )
    ) axxx
FROM
    test1 a
GROUP BY
    a.id,
    a.coin,
    a.direction,
    D,
    E
</code></pre>
          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://hero.triple.net.cn/2018/01/16/e5-85-ab-e5-b9-b4phper-e7-9a-84-e9-ab-98-e7-ba-a7-e5-b7-a5-e7-a8-8b-e5-b8-88-e9-9d-a2-e8-af-95-e4-b9-8b-e8-b7-af/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="$$ Welcome $$">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Technician">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/01/16/e5-85-ab-e5-b9-b4phper-e7-9a-84-e9-ab-98-e7-ba-a7-e5-b7-a5-e7-a8-8b-e5-b8-88-e9-9d-a2-e8-af-95-e4-b9-8b-e8-b7-af/" class="post-title-link" itemprop="https://hero.triple.net.cn/page/3/index.html">八年phper的高级工程师面试之路</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-01-16 12:14:16" itemprop="dateCreated datePublished" datetime="2018-01-16T12:14:16+08:00">2018-01-16</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-12 17:08:58" itemprop="dateModified" datetime="2018-12-12T17:08:58+08:00">2018-12-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/技术分类/" itemprop="url" rel="index"><span itemprop="name">技术分类</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="八年phper的高级工程师面试之路"><a href="#八年phper的高级工程师面试之路" class="headerlink" title="八年phper的高级工程师面试之路"></a>八年phper的高级工程师面试之路</h1><p>这是一篇反面教材，希望也能引起部分程序员的警惕。 最近半个月时间，经过几次面试，差不多已经对自己有了定位————距离腾讯T3岗位还是有一点距离。 因为在一家小公司呆的习惯了（6年），公司没有人在技术层面超过我，作为技术核心，感觉自己很牛，活在一个小圈子里面，几乎不会主动去了解新技术，甚至对php以及js本身都不能算精通。 所以变故出现的时候，我才发现自己的技术脱节有多厉害，虽然之前的面试并没有做专门的准备，但是与6年前找工作的情形相比，差距非常的大。 下面是我整理的一部分遇到的面试题，我尽量用我所知道的知识来进行陈述，肯定会有很多误解以及遗漏，希望大家能够指正。 公司1： <strong>1、mysql_real_escape_string mysql_escape_string有什么本质的区别，有什么用处，为什么被弃用？</strong> 答：mysql_real_escape_string需要预先连接数据库，并可在第二个参数传入数据库连接（不填则使用上一个连接） 两者都是对数据库插入数据进行转义，但是mysql_real_escape_string转义时，会考虑数据库连接的字符集。 它们的用处都是用来能让数据正常插入到数据库中，并防止sql注入，但是并不能做到100%防止sql注入。 再问：为什么不能100%防止？ 答；因为客户端编码以及服务器端编码不同，可能产生注入问题，但是其实这种场景不多见。 继续答：被弃用的原因是官方不再建议使用mysql_xx的数据库操作方式，建议使用pdo和mysqli，因为不管从性能跟安全来看，mysqli都比mysql要好。 衍生出来的问题是mysqli的连接复用（持久化）问题，这一块我并没有答好。 <strong>2、什么是内存泄漏，js内存泄漏是怎么产生的？</strong> 答：内存泄漏是因为一块被分配内存既不能被使用，也不能被回收，直到浏览器进程结束。 产生泄漏的原因是闭包维持函数内局部变量，不能被释放，尤其是使用闭包并存在外部引用还setInterval的时候危害很大。 备注：我觉得这块回答并不好，因为肯定不是闭包的原因。 我查了一下资料，从比较浅的方位来再回答一下这个问题： 产生泄漏的原因有好几种： (1) 页面元素被删除，但是绑定在该元素上的事件未被删除； (2) 闭包维持函数内局部变量（外部不可控），使其得不到释放； (3) 意外的全局变量； (4) 引用被删除，但是引用内的引用，还存在内存中。 从上述原因上看，内存泄漏产生的根本原因是引用无法正确回收，值类型并不能引发内存泄漏。 对于每个引用，都有自己的引用计数，当引用计数归零或被标记清除时，js垃圾回收器会认为该引用可以回收了。 <strong>3、什么是闭包，跟原型链、作用域链有什么关联</strong> 答：闭包是指存在于一个作用域链分支的函数域内的函数，该函数可以向上逐级访问作用域链上的变量，直到找到为止。当闭包存在外部引用时，js会维持闭包自身以及所在函数作用域链的内存状态。 备注：这个是我自己瞎说的。 继续答：跟原型链没有什么关联，函数的原型（prototype）主要用于实现继承，原型链可用于追溯继承关系，与作用域链类似，都是向上逐级访问属性，直到被找到，原型链的顶层是null，可以理解为所有的object都继承至null，所以null的类型是object。 继续答：作用域链可以看作是一个树形结构，由根节点window向下扩散，下层节点可以访问上层节点，但是上层节点无法访问下层节点，产生闭包的函数作用域属于节点中的一个，向下扩散后闭包函数产生叶子节点，叶子节点之间可以互相访问，当访问的变量在叶子节点中无法找到时，向上层节点查找，直到被找到为止，这个概念有点类似原型链上的属性查找。 <strong>4、一台电脑配置无限好，可以同时打开多少个网页</strong> 答：65535-1000 = 64535（端口数） // 1024 <strong>5、ip地址能被伪造吗？</strong> 答：http头部可以被篡改，但是只能修改X_FORWARDED_FOR，真实ip地址（REMOTE_ADDR）很难修改（除非是路由器去修改），因为真实ip是底层会话ip地址，而且因为TCP 3次握手的存在，连接无法建立，伪造的意义不大，至于UDP的话，一般是内网才使用UDP通信。 <strong>6、有100万个奖品，每个人可以中奖3次，先到先得，怎么控制并发，不能发超，并保证完全的先到先得模式</strong> 答：百万奖品在打乱后预先insert到数据库，所有中奖操作，均只能update，不能insert。进来抽奖的用户使用memcahe原子加锁，实现抽奖次数自增，当抽奖次数到达3时，返回不中奖。 再问：预先插入需要很多资源，如果奖品数量上了1亿怎么办？ 答：使用redis队列存储请求，跑守护进程异步发奖，产生的问题是用户无法实时看到中奖情况。 再问：这样肯定不行。 再答：使用全局内存加锁确保抽奖过程是单进程在跑，但是会面临大并发阻塞问题。 再问：内存比较宝贵，在不用内存加锁的情况下怎么办，并且如果碰到1亿奖池的情况，预先插入数据库肯定不好，怎么办？ 答：设置奖品概率，分三张表，都使用innodb引擎，一张存中奖记录（预先插入一行），一张存奖品发放概况，一张存用户抽奖情况（uin唯一索引），大并发情况下，利用mysql的排他锁进行并发控制。流程如下： begin 查询用户抽奖次数，加排他锁 对用户抽奖次数的更新/插入 锁行查询发放情况 获得抽奖结果（某些奖品发完之后，动态变更概率） 更新发放表 插入中奖记录 commit 再问：遇到脏读怎么办？ 答：这方面不是很了解 再问：innodb的master线程在什么情况下fork其他子线程？ 答：不知道 <strong>7、数据链路层的数据是怎么校验的，有哪些校验方式？</strong> 答：crc32，别的校验可能是取模校验奇偶数吧。 备注：答个crc校验就行了。 <strong>8、b+树的查询时间复杂度是多少，哈希表是多少，为什么数据库索引用b+树存储，而不是哈希表，数据库索引存储还有其他数据结构吗？</strong> 答：O(log(n))，O(1) 因为哈希表是散列的，在遇到`key`&gt;’12’这种查找条件时，不起作用，并且空间复杂度较高。 备注：b+数根据层数决定时间复杂度，数据量多的情况下一般4-5层，然后用二分法查找页中的数据，时间复杂度远小于log(n)。 <strong>9、apache是怎么跟php通讯的，sapi是什么</strong> 答：使用sapi通讯，sapi是php封装的对外数据传递接口，通常有cgi/fastcgi/cli/apache2handler四种运行模式。 <strong>10、php的垃圾回收机制？</strong> 答：垃圾回收是指当php运行状态结束时，比如遇到了exit/die/致命错误/脚本运行结束时，php需要回收运行过程中创建的变量、资源的内存。 ZEND引擎维护了一个栈zval，每个创建的变量和资源都会压入这个栈中，每个压入的数组结构都类似：[refcount =&gt; int, is_ref =&gt; 0|1, value =&gt; union, type =&gt; string]，变量被unset时，ref_count如果变成0，则被回收。 当遇到变量循环引用自身时，使用同步回收算法回收。 备注：PHP7已经重写了zal的结构体。 <strong>11、jquery的sizzle引擎工作原理</strong> 答：除了直到是DOM元素查找引擎之外，一无所知。 <strong>12、seajs的工作原理，如何解决重复加载库的问题，如何进行资源的同步加载</strong> 答：建立映射关系并缓存起来；资源并不能真正同步加载，只是返回一个回调。 <strong>13、memcache跟redis的区别</strong> 答：可存储数据结构不同；redis支持持久化存储。 <strong>14、md5逆向原理</strong> 答：先用字典查找，再尝试暴力破解。 再问：没有更好的方法了吗？ 答：没有了。 备注：嗯，事实上也确实没有特别好的办法，只能使用TB级的海量特征库用数据库存起来，然再分片查找。 <strong>15、父类方法是protected，子类重构为private，会发生什么？</strong> 答：会发生fatal错误，因为继承的方法或属性只能维持或放大权限，不能缩小，比如protected重载为public是可行的。 <strong>16、一个网页从输入地址回车，到完整展示网页内容这段时间里，做了哪些工作，越详细越好。</strong> 答： 0、浏览器本地缓存匹配； 1、本地hosts映射对比; 2、本地dns缓存解析； 3、远程dns解析获得服务器ip地址； 4、浏览器发送tcp连接请求包(syn)； 5、请求包经过传输层、网络层、数据链路层封装通过网卡到达路由器； 6、路由器转发数据包到所属运营商服务器； 7、运营商服务器通过寻址最短路径通过中继节点到达指定ip地址； 8、服务器端可能存在反向代理或者负载均衡，都是直接转发请求至上游服务器，当然也可以制定安全防御规则直接丢弃请求包； 9、上游服务器收到连接请求，在自身可用的情况下，返回(syn+ack)； 10、浏览器校验ack，再次发送(syn+ack)； 11、服务器校验ack切换连接状态至established，然后根据请求传输数据包； 12、当transform-encoding为chunked时，浏览器开始渲染页面； 13、四次挥手，连接关闭； 14、渲染数据完成。 备注：还有很多东西不懂，一些东西完全是自己瞎蒙的，因为时间原因，以后有时间详细画一下。 <strong>17、keep-alive的概念</strong> 答：长连接机制，表示keep-alive-timeout时间内，如果连接没有closed，再次传输数据不再需要三次握手了。 备注：这里也有很多疑问，需要好好捋一捋。 <strong>18、linux文件压缩操作命令，shell脚本等</strong> 备注：因为平时开发都是在windows环境，对linux了解不足，这一块几乎是0分。 公司2： 这个是被鄙视最惨的一家了，首先会有笔试，相对来说并不复杂，但是有些坑，很多已经忘记了。 印象深刻的是我说自己熟悉常用设计模式，然后让我画UML类图，我就懵逼了，所以在写简历的时候，最好是写自己非常熟悉的，如果只是一知半解，并没有必要放到简历中。 公司3： 这里仅列举几个问到的问题： 1、设计一个中继服务器，转发客户A-&gt;客户B的请求； 2、myisam跟innodb有什么区别； 3、php进程死锁产生的原因是什么？怎么自动排查与自动恢复？ 4、有class A { public function b($a, $b, $c){//ssss}}; 怎么使用[‘b’ =&gt; 2, ‘a’ =&gt; 1, ‘c’ =&gt; 3]，对进行A::b进行调用，并顺利赋值？ 5、php5.2-&gt;php7.1的各版本演进历史，新增特性等？ 6、画一个tcp三次握手图 目前还在找工作中，在我看来8年的程序员怎么也不应该是这样子的，温水煮青蛙的教训非常惨痛，好在现在认识到问题还不晚，等到了35岁这个年纪，可能就真的晚了。 <a href="https://www.zhihu.com/topic/19552910" target="_blank" rel="noopener">PHP</a> 高级php架构师   觉得他们的面试题出的未必是好 题主已说面岗是架构师 虽然我不是架构师 但是我接触到的架构师应该具备的能力模型我觉得有几点比较重要 技术选型（知识面要广，不仅要考虑到公司的团队效率还要考虑到所选技术遇到问题解决所需的时间成本）、技术难点攻克（算法和并发模型或者存储方案的搭配），学习能力（不论年龄 这是必须 因为技术本是日新月异），管理能力（这个包括但不限于 人员管理、定期的技术沉淀、项目控制等），业务分析到技术实现的能力（其实架构师很大一部分壁垒是对业务理解非常深刻 一些具体实现未必要事必躬亲 因为本来你的时间成本就是应该发挥其最大价值 就是带领并指导团队快速开发产品的），解决问题的能力（bug出现时你一定要出现在一线指导或者亲自快速解决）其他的想到的再说吧 补充一些：鉴于技术人员的天生不服的性格 所以一般架构师技术不过硬是服不了人的 所以像一些底层的东西还是需要深入了解的 网络 协议 存储db 设计模式 算法 数据结构 未必细节要全部记住 但是要做到已知所以然 知其然只需要稍看文档即可 最后回归下腾讯的面试题吧 他们的考察点太单一了 毕竟是一个已然涉及管理岗的职位 但是题目还是较多在技术的细节点上 像是一个普通程序员岗的面试题 当然有一些可能是在其他几面中高管会面谈测探 我没面过腾讯所以有下错误定论的可能 只是希望给所有技术人员一点职业发展中应该平衡一下自己的重点 这样才不至于被淘汰</p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://hero.triple.net.cn/2018/01/12/something-about-get-browsers-info/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="$$ Welcome $$">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Technician">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/01/12/something-about-get-browsers-info/" class="post-title-link" itemprop="https://hero.triple.net.cn/page/3/index.html">关于获取浏览器语言的一些调查</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-01-12 17:13:03" itemprop="dateCreated datePublished" datetime="2018-01-12T17:13:03+08:00">2018-01-12</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-18 12:34:13" itemprop="dateModified" datetime="2018-12-18T12:34:13+08:00">2018-12-18</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/大前端！/" itemprop="url" rel="index"><span itemprop="name">大前端！</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今天有一个需求过来:</p>
<blockquote>
<p>要根据用户使用的语言自动将官网切换成对应的语种. 呶,就那么 _简单_ 的需求 </p>
</blockquote>
<p>实际上实现起来也不是特别复杂,切换方法都有,网站原来已经做了本地化处理,不过是需要客户手动选择 </p>
<p>然后, 很快写了一段JS, 通过js获取浏览器语言, 然后再做匹配. 代码很简单:</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">      $(document).ready(function () &#123;</span><br><span class="line">    	var currLang = $.cookie(&apos;lang&apos;);</span><br><span class="line">    	// 如果本地已经保存过语言设定，使用本地的；否则，从浏览器重新获取语言</span><br><span class="line">    	if (typeof (currLang) == &apos;undefined&apos; || currLang == &apos;&apos;) &#123;</span><br><span class="line">    		currLang = window.navigator.language;</span><br><span class="line">    		if (!currLang) &#123;</span><br><span class="line">    			currLang = window.navigator.browserLanguage;</span><br><span class="line">    		&#125;</span><br><span class="line">    		if (currLang != &apos;zh-CN&apos; &amp;&amp; currLang != &apos;en-US&apos;) &#123;</span><br><span class="line">    			// 既不是中文，也不是英文，则使用英文作为默认显示语言</span><br><span class="line">    			currLang = &apos;en-US&apos;;</span><br><span class="line">    		&#125;</span><br><span class="line">    		changeLang(currLang);</span><br><span class="line">    	&#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">```    </span><br><span class="line"></span><br><span class="line">丢到测试环境, Firefox,Chrome 跑一通，正常！ </span><br><span class="line">然而在IE 下，就不行了，，，， 我操作系统是中文的，IE 默认语言也是中文，</span><br><span class="line">在 `常规`-`外观`-`语言` 里面看到有设置的地方，改为英语，无效;</span><br><span class="line">删除中文，只留英语，还是无效;</span><br><span class="line">然后，把网上流传的三种获取语言的方式都在IE里面试一遍：</span><br><span class="line"></span><br><span class="line">```    </span><br><span class="line">    alert(window.navigator.userLanguage);</span><br><span class="line">    alert(window.navigator.systemLanguage);</span><br><span class="line">    alert(window.navigator.language);</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">IE 显示的都是 `zh-CN` ! </span><br><span class="line"></span><br><span class="line">不服，把 `navigator` 的所有属性都打印了一遍（需要的拿走）：</span><br></pre></td></tr></table></figure></div>
<pre><code>//属性  
document.write( window.navigator.appCodeName + &quot; ------ //返回与浏览器相关的内部代码名  都为Mozilla   
&quot;);
document.write(navigator.appName + &quot; ------ //返回浏览器正式名称  均为Netscape   
&quot;);
document.write(navigator.appVersion + &quot; ------ //返回浏览器版本号   
&quot;);
document.write(navigator.cookieEnabled + &quot; ------ //返回浏览器是否启用cookie，true和false   
&quot;);
document.write(navigator.geolocation + &quot; ------ //返回地理定位信息(h5)   
&quot;);
document.write(navigator.javaEnabled() + &quot; ------ //检测当前浏览器是否支持 Java，从而知道浏览器是否能显示 Java 小程序(IE,chrome返回true，firefox返回false)   
&quot;);
document.write(navigator.language + &quot; ------ //返回浏览器的首选语言   
&quot;);
document.write( navigator.mimeTypes + &quot; ------ //返回浏览器支持的Mime类型   
&quot;);
document.write( navigator.msManipulationViewsEnabled + &quot; ------ //仅支持IE，true   
&quot;);
document.write(navigator.msMaxTouchPoints + &quot; ------ //字面意思是最大的触摸点，IE为0，其他不支持   
&quot;);
document.write(navigator.msPointerEnabled + &quot; ------ //IE为true，其他不支持   
&quot;);
document.write(navigator.onLine + &quot; ------ //是否连接互联网，均返回true(未断网)   
&quot;);
document.write(navigator.platform + &quot; ------ //所在平台，返回win32   
&quot;);
document.write(navigator.plugins + &quot; ------ //返回浏览器插件集合   
&quot;);
document.write(navigator.preference + &quot; ------ //允许一个已标识的脚本获取并设置特定的 Navigator 参数   
&quot;);
document.write( navigator.product + &quot; ------ //浏览器产品名，返回gecko   
&quot;);
document.write(navigator.systemLanguage + &quot; ------ //获取系统语言，IE支持，返回zh-cn   
&quot;);
document.write(navigator.userAgent + &quot; ------ //判断浏览器类型   
&quot;);
document.write(navigator.userLanguage + &quot; ------ //返回操作系统的自然语言设置,IE支持，返回zh-cn   
&quot;);
//方法  
document.write(navigator.msLaunchUri + &quot; ------ //回调函数，未研究   
&quot;);
document.write(navigator.taintEnabled + &quot; ------ //回调函数   
&quot;);
document.write(navigator.hasOwnProperty + &quot; ------ //意思是是否支持属性，用法如下   
&quot;);
document.write(document.hasOwnProperty(&quot;ontouchstart&quot;) + &quot; ------ //电脑返回false，手机为true   
&quot;);
console.log(navigator);
</code></pre><p><code>`</code> </p>
<p>显示结果：<br><img src="https://tech.msla.top/wp-content/uploads/2018/04/navigator_on_IE11.png" alt="IE 的 navigator属性和方法"> </p>
<p>一个`en-US`的影子也没</p>
<p>继续找方法， </p>
<p>在 Mozilla 官方文档上看到<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Navigator" target="_blank" rel="noopener">关于 Navigator 的定义</a><br>貌似有一个 <code>navigator.languages</code> 的属性（<code>language</code> 后面有个 <em><code>s</code></em>），拿到IE下面打印一下： </p>
<p>`undefined` 。。。 </p>
<p>这就悲剧了，意思是，和操作系统语言有关，IE 留的这个功能没啥用处。。。<br>网上看来有像我一样不死心的人，跑到 <a href="https://answers.microsoft.com/zh-hans/ie/forum/ie10-windows_7/js%E5%A6%82%E4%BD%95%E8%8E%B7%E5%8F%96ie%E6%B5%8F/25abb93e-c084-49f8-aa2a-6fd904f9eb19" target="_blank" rel="noopener">Microsoft 官方论坛</a> 还有这里： <a href="https://social.msdn.microsoft.com/Forums/ie/en-US/a5190b18-a49b-49b2-ac7a-2af433c0319a/detect-ie-language-preference" target="_blank" rel="noopener">https://social.msdn.microsoft.com/Forums/ie/en-US/a5190b18-a49b-49b2-ac7a-2af433c0319a/detect-ie-language-preference</a><br>结果就是，，，， 他们自己也不知道。。。 </p>
<p>然后再去找，偶然发现 <code>ip.chinaz.com</code> 页面显示的语言居然是我浏览器设定的。。 神奇！！<br>仔细一看，原来诀窍在这里，看图：<br><img src="https://tech.msla.top/wp-content/uploads/2018/04/network_on_request_chinaz.png" alt="通过Header获取语言信息"> </p>
<p>chianz 没用直接通过js获取语言（估计他们也研究过这个问题），而是在点击“展开更多”那个按钮时发送一个GET请求，然后获取当次请求中的Header中的属性（`Accept-Language`）</p>
<p>果然很专业！<br>剩下的问题，就简单了，依葫芦画瓢呗～～</p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://hero.triple.net.cn/2018/01/09/php-e7-9a-84aes-e5-af-b9-e7-a7-b0-e5-8a-a0-e5-af-86-e5-b0-8f-e8-ae-a1/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="$$ Welcome $$">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Technician">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/01/09/php-e7-9a-84aes-e5-af-b9-e7-a7-b0-e5-8a-a0-e5-af-86-e5-b0-8f-e8-ae-a1/" class="post-title-link" itemprop="https://hero.triple.net.cn/page/3/index.html">PHP的AES 对称加密小计</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-01-09 17:03:34" itemprop="dateCreated datePublished" datetime="2018-01-09T17:03:34+08:00">2018-01-09</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-12 17:22:01" itemprop="dateModified" datetime="2018-12-12T17:22:01+08:00">2018-12-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/技术分类/" itemprop="url" rel="index"><span itemprop="name">技术分类</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>对称加密在很多地方有独特的应用需要， 并且经实测，加密解密效率也不错， 我服务器上 双核2G，PHP7.0 使用 openssl_encrypt 模块加密并解密 三万六千个字符，耗时大约 0.5 <strong>毫</strong>秒（ 0.00048s），速度非常快 对于个人加密数据来说已经足够了 有些小问题需要记一下： 1. openssl_encrypt 模块必须要有非NULL的初始化向量（IV） 2. 加密和解密是没有雪崩效应的，特别是解密，在密文后面追加字符，并不会显著影响前面的密文的解密，只是后面追加的字符无法解密而已，前面的照常显示 3. 老版本PHP使用的的 Mcrypt 模块密钥长度是16位（可能是部分加密方法，未完全测试），openssl 没有此限制 通用加密/解密使用方法：  </p>
<pre><code>/**
 * [AesSecurity aes加密，支持PHP7.1]
 */
class AesSecurity
{
 /**
  * [encrypt aes加密]
  * @param [type]     $input [要加密的数据]
  * @param [type]     $key [加密key]
  * @return [type]       [加密后的数据]
  */
 public static function encrypt($input, $key)
 {
  $data = openssl_encrypt($input, &apos;AES-128-ECB&apos;, $key, OPENSSL_RAW_DATA);
  $data = base64_encode($data);
  return $data;
 }
 /**
  * [decrypt aes解密]
  * @param [type]     $sStr [要解密的数据]
  * @param [type]     $sKey [加密key]
  * @return [type]       [解密后的数据]
  */
 public static function decrypt($sStr, $sKey)
 {
  $decrypted = openssl_decrypt(base64_decode($sStr), &apos;AES-128-ECB&apos;, $sKey, OPENSSL_RAW_DATA);
  return $decrypted;
 }
}
</code></pre>
          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://hero.triple.net.cn/2017/12/26/centos-7-2-e4-b8-8b-e7-bc-96-e8-af-91-e5-ae-89-e8-a3-85php-7/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="$$ Welcome $$">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Technician">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/12/26/centos-7-2-e4-b8-8b-e7-bc-96-e8-af-91-e5-ae-89-e8-a3-85php-7/" class="post-title-link" itemprop="https://hero.triple.net.cn/page/3/index.html">CentOS 7.2下编译安装PHP 7</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-12-26 18:12:01" itemprop="dateCreated datePublished" datetime="2017-12-26T18:12:01+08:00">2017-12-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-12 16:59:08" itemprop="dateModified" datetime="2018-12-12T16:59:08+08:00">2018-12-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/操作系统/" itemprop="url" rel="index"><span itemprop="name">操作系统</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>注意此配置针对开发环境，如果线上环境，那么phpdbg和dtrace这两个建议不要编译 编译安装参数</p>
<pre><code># prefix 可根据实际情况自定义
# with-fpm-systemd参数可以使PHP7支持centos7的systemd服务管理
# 安装过程中可能有一些扩展需要额外库支持，如果configure运行报错，直接goolge 搜索，基本上yum install xxx-devel 就可

./configure --prefix=/data/soft/php7
 --enable-fpm
 --with-fpm-user=php-fpm
 --with-fpm-group=www
 --with-fpm-systemd
 --enable-phpdbg
 --enable-dtrace
 --enable-mysqlnd
 --with-mysqli=mysqlnd
 --with-pdo-mysql=mysqlnd
 --enable-opcache
 --enable-pcntl
 --enable-mbstring
 --enable-soap
 --enable-zip
 --enable-calendar
 --enable-bcmath
 --enable-ftp
 --enable-intl
 --enable-sockets
 --with-openssl
 --with-mhash
 --with-zlib
 --with-curl
 --with-gettext
 --with-gd
 --enable-exif
 --enable-gd-native-ttf
 --enable-gd-jis-conv
 --with-png-dir=/usr/lib
 --with-jpeg-dir=/usr/lib
 --with-freetype-dir=/usr/lib
</code></pre><p>执行以上编译前配置，如果没有错误 运行命令</p>
<pre><code>make &amp; make install
</code></pre><p>编译完成，copy php-develpment.ini 文件到 PREFIX/lib/目录下</p>
<hr>
<p>一些特别需要注意安装的包</p>
<pre><code>yum install systemd-devel
yum isntall freetype-devel
yum isntall libpng-devel
yum install openjpeg-devel
</code></pre><p>安装完，如果想要systemd控制启动 copy ./sapi/fpm/php-fpm.service 到 /usr/lib/systemd/system/下 systemctl enable php-fpm systemctl start php-fpm 即可 编译安装完，就是一些第三方扩展安装，能用pecl的尽量使用pecl，不能用的编译安装也简单，使用phize 这个即可，具体自己搜索网上文章 另外就是php.ini配置文件的修改和php-fpm.conf文件的修改，一些最基本的优化都可以在这两个文件里面实现，比如opcache的配置，php-fpm启动进程数量等，php-fpm配置文件在PREFIX/etc目录下 因为是开发环境，优化的就不写了，如果有需要，网上搜索，基本上优化的建议都很通用 文章来源： <a href="https://segmentfault.com/a/1190000005363212" target="_blank" rel="noopener">https://segmentfault.com/a/1190000005363212</a></p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://hero.triple.net.cn/2017/12/22/e4-bd-bf-e7-94-a8snk-e5-af-86-e9-92-a5-e6-96-87-e4-bb-b6-e4-bf-9d-e6-8a-a4-e4-bd-a0-e7-9a-84dll-e5-92-8c-e4-bb-a3-e7-a0-81-e4-b8-8d-e8-a2-ab-e5-8f-8d-e7-bc-96-e8-af-91-e6-95-99-e7-a8-8b/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="$$ Welcome $$">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Technician">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/12/22/e4-bd-bf-e7-94-a8snk-e5-af-86-e9-92-a5-e6-96-87-e4-bb-b6-e4-bf-9d-e6-8a-a4-e4-bd-a0-e7-9a-84dll-e5-92-8c-e4-bb-a3-e7-a0-81-e4-b8-8d-e8-a2-ab-e5-8f-8d-e7-bc-96-e8-af-91-e6-95-99-e7-a8-8b/" class="post-title-link" itemprop="https://hero.triple.net.cn/page/3/index.html">使用SNK密钥文件保护你的DLL和代码不被反编译教程</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-12-22 16:45:46" itemprop="dateCreated datePublished" datetime="2017-12-22T16:45:46+08:00">2017-12-22</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-12 17:05:36" itemprop="dateModified" datetime="2018-12-12T17:05:36+08:00">2018-12-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/技术分类/" itemprop="url" rel="index"><span itemprop="name">技术分类</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>大家做项目开发一般都是分层的，比如UI层，业务层，数据访问层。业务层引用数据访问层的DLL(比如dataAccess.dll)，并使用dataAccess.dll中的方法。当项目完成并给客户用了，可有些心里BT的客户这个时候也可以请个稍微懂NET的人来引用你的dataAccess.dll并调用其中的方法搞破坏。比如可以直接使用里面的ChangePwd(string UserName,string Pwd)方法把其他用户的密码改了，这个时候就你就……. 好了，该开始说怎么保护我们的代码了：</p>
<h3 id="首先我们需要把我们的程序集做成强命名的程序集。"><a href="#首先我们需要把我们的程序集做成强命名的程序集。" class="headerlink" title="首先我们需要把我们的程序集做成强命名的程序集。"></a>首先我们需要把我们的程序集做成强命名的程序集。</h3><p>这里我们在.NET 命令提示中输入<code>sn -k c:test.snk</code> 创建一个新的随机密钥对并将其存储在 <code>c:test.snk</code> 中 然后新建立类库<code>ClassLibrary1</code>，里面只有个类文件<code>Class1.cs</code>，代码如下：</p>
<pre><code>using System;
namespace ClassLibrary1
{
    public class Class1
    {
        public Class1()
        {
            //
            // TODO: 在此处添加构造函数逻辑
            //
        }

        public string Insert()
        {
            return &quot;ok&quot;;
        }
    }
}
</code></pre><p><strong>AssemblyInfo.cs代码：</strong></p>
<pre><code>//............其他的就用默认

[assembly: AssemblyKeyFile(&quot;c:test.snk&quot;)] // 连接上面用强命名工具SN.exe生成的文件.
</code></pre><p>接着创建个WindowApplication来调用我们的ClassLibrary1，代码：</p>
<pre><code>private void button1_Click(object sender, System.EventArgs e)
{
    MessageBox.Show(new ClassLibrary1.Class1().Insert());
}
</code></pre><p>不修改WindowApplication的AssemblyInfo.cs。 在这里就可以直接运行了，不过大家都看的出来，这样是能成功调用Class1中的方法的。 现在让我们来修改下<code>Class1.cs</code>，代码：</p>
<pre><code>using System;
using System.Security.Permissions;

namespace ClassLibrary1
{
[StrongNameIdentityPermissionAttribute(SecurityAction.LinkDemand, PublicKey =
&quot;00240000048000009400000006020000002400005253413100040000010001000551684edd1600&quot;+
&quot;8ccbdd337b1cf1490490d97fe0048c5f3629cc4f5104578499eace9b2a94115022edd620def472&quot;+
&quot;8b4f088291cfa77a40659afba611fdafbb7894b93a64049d439936bd0cd8dc0704625aeb735892&quot;+
&quot;e9eb3f910a49a2925af10515d935654d7adac5567ff6d780d23d587de0ff4d271da7b30680fa88&quot;+
&quot;a47a4ba4&quot;)]
public class Class1
{
    public Class1()
    {
        //
        // TODO: 在此处添加构造函数逻辑
        //
    }

    public string Insert()
    {
        return &quot;ok&quot;;
    }
    }
}
</code></pre><p>然后再编译后运行windowapplication调用class1中的方法就会出错。 这里的<code>StrongNameIdentityPermissionAttribute</code>是NET提供的<code>CAS(Code Access Security)</code>中的1个类，具体可参考MSDN， <code>SecurityAction.LinkDemand</code> 是要求直接调用方已被授予了指定的权限，这里即windowapplication要授予了权限才行， 如果使用<code>SecurityAction.Demand</code>要求调用堆栈中的所有高级调用方都已被授予了当前权限对象所指定的权限。 他们的区别是： 如果windowapplication已授权访问，而还有个windowapplication2(未授权访问)通过调用windowapplication中的<code>button1_Click</code>方法来调用class1，这个时候如果使用<code>SecurityAction.LinkDemand</code>就能成功调用， 而使用<code>SecurityAction.Demand windowapplication2</code>就不能调用，windowapplication 在这2种情况下都能调用。 说到这里大家一定再问PublicKey＝后面一串那么长的字符串怎么来。PublicKey后面的字符串是你开始生成的<code>c:test.snk</code>文件中保存的公钥。那怎么才能看到这个公钥了，照样是用SN.EXE。 输入<code>sn -p c:test.snk c:publicKey.snk</code> (从 test.snk 中提取公钥并将其存储在 publicKey.snk 中) 再输入<code>sn -tp c:publicKey.snk</code> (显示公钥信息) 上面这个命令就能看到PublicKey后面的字符串了，还想什么啊，把那字符串copy下来啊。 最后大家一定在关心这个时候windowapplication 要怎么调用class1了，其实也简单，只要把<code>windowapplication</code> 的<code>AssemblyInfo.cs</code>修改为：</p>
<pre><code>[assembly: AssemblyKeyFile(&quot;c:test.snk&quot;)]
</code></pre><p>到这里就一切OK了，大家都看到最关键的就是test.snk文件了，所以一定要保护好你自己的test.snk文件。</p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <p class="site-description motion-element" itemprop="description">$$ Welcome $$</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">174</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">9</span>
                    <span class="site-state-item-name">分类</span>
                  
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">214</span>
                    <span class="site-state-item-name">标签</span>
                  
                </div>
              
            </nav>
          

          

          

          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  

  
</div>









        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>














  
    
      
        
      
  
  <script type="text/javascript" color="0,0,255" opacity="0.5" zindex="-1" count="99" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1.0.0/canvas-nest.min.js"></script>











  



  
  
    <script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/reading_progress/reading_progress.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.6.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.6.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.6.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.6.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.6.0"></script>



  



  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  
  

  

  

  

  
  
  
  <script src="/lib/bookmark/bookmark.min.js?v=1.0"></script>
  <script type="text/javascript">
  
    bookmark.loadBookmark();
  
  </script>


  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #333;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #eee;
      background-image: linear-gradient(#fcfcfc, #eee);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>
  <script>
    $('.highlight').each(function (i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap')
      $(e).after($wrap)
      $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function (e) {
        var code = $(this).parent().find('.code').find('.line').map(function (i, e) {
          return $(e).text()
        }).toArray().join('\n')
        var ta = document.createElement('textarea')
        document.body.appendChild(ta)
        ta.style.position = 'absolute'
        ta.style.top = '0px'
        ta.style.left = '0px'
        ta.value = code
        ta.select()
        ta.focus()
        var result = document.execCommand('copy')
        document.body.removeChild(ta)
        
          if(result)$(this).text('复制成功')
          else $(this).text('复制失败')
        
        $(this).blur()
      })).on('mouseleave', function (e) {
        var $b = $(this).find('.copy-btn')
        setTimeout(function () {
          $b.text('复制')
        }, 300)
      }).append(e)
    })
  </script>


  

</body>
</html>
