<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">

  <!-- PACE Progress Bar START -->
  
    <script src="https://raw.githubusercontent.com/HubSpot/pace/v1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="/themes/hiero/source/css/pace-theme-flash.css">
  
  

  <!-- PACE Progress Bar START -->

  
  <title>Technician</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  
  <meta name="description" content="$$ Welcome $$">
<meta property="og:type" content="website">
<meta property="og:title" content="Technician">
<meta property="og:url" content="https://www.cobsun.com/page/11/index.html">
<meta property="og:site_name" content="Technician">
<meta property="og:description" content="$$ Welcome $$">
<meta property="og:locale" content="zh-cn">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Technician">
<meta name="twitter:description" content="$$ Welcome $$">
  
    <link rel="alternate" href="/atom.xml" title="Technician" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="https://cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/hiero.css">
  <link rel="stylesheet" href="/css/glyphs.css">
  
    <link rel="stylesheet" href="/css/vdonate.css">
  

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/my.css">
  <!-- Google Adsense -->
  
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
      (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "",
          enable_page_level_ads: true
      });
  </script>
  
</head>
</html>
<script>
var themeMenus = {};

  themeMenus["/"] = "Home"; 

  themeMenus["/archives"] = "Archives"; 

  themeMenus["/categories"] = "Categories"; 

  themeMenus["/tags"] = "Tags"; 

  themeMenus["/about"] = "About"; 

</script>


  <body>


  <header id="allheader" class="site-header" role="banner">
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="Technician" rel="home"> Technician </a>
            
          </h1>

          
            <div class="site-description">$$ Welcome $$</div>
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>
            <div class="clearfix sf-menu">

              <ul id="main-nav" class="nmenu sf-js-enabled">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/">Home</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/archives">Archives</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/categories">Categories</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/tags">Tags</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/about">About</a> </li>
                    
              </ul>
            </div>
          </nav>


      </div>
  </div>
</header>


  <div id="originBgDiv" style="background: #fff; width: 100%;">

      <div style="max-height:600px; overflow: hidden;  display: flex; display: -webkit-flex; align-items: center;">
        <img id="originBg" width="100%" alt="" src="">
      </div>

  </div>

  <script>
  function setAboutIMG(){
      var imgUrls = "css/images/pose.jpg,https://source.unsplash.com/collection/954550/1920x1080".split(",");
      var random = Math.floor((Math.random() * imgUrls.length ));
      if (imgUrls[random].startsWith('http') || imgUrls[random].indexOf('://') >= 0) {
        document.getElementById("originBg").src=imgUrls[random];
      } else {
        document.getElementById("originBg").src='/' + imgUrls[random];
      }
  }
  bgDiv=document.getElementById("originBgDiv");
  if(location.pathname.match('about')){
    setAboutIMG();
    bgDiv.style.display='block';
  }else{
    bgDiv.style.display='none';
  }
  </script>



  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main">
  
    <article id="post-nginx-e4-b8-8bcodeiginter-e9-85-8d-e7-bd-ae" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/05/04/nginx-e4-b8-8bcodeiginter-e9-85-8d-e7-bd-ae/">Nginx下CodeIginter配置</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2017/05/04/nginx-e4-b8-8bcodeiginter-e9-85-8d-e7-bd-ae/" class="article-date">
	  <time datetime="2017-05-04T03:26:21.000Z" itemprop="datePublished">五月 4, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>Example, when none-configured: <code>http://127.0.0.1/ci/index.php/hello/index</code></p>
<h3 id="Method-1"><a href="#Method-1" class="headerlink" title="Method 1:"></a>Method 1:</h3><p>当nginx找不到文件和目录时，不返回404，而是重定向到index.php入口文件</p>
<pre><code>location /ci/ { 
        # First attempt to serve request as file, then
        # as directory, then fall back to displaying a 404.
        try_files $uri $uri/ /ci/index.php;
}
</code></pre><h3 id="Method-2："><a href="#Method-2：" class="headerlink" title="Method 2："></a>Method 2：</h3><pre><code>location /ci/ {            
      if (!-e $request_filename) {
            rewrite  ^/(.*)$  /ci/index.php?$1 last;                          
            break;             
      }                      
}
</code></pre><p>  个人配置：</p>
<h3 id="application-—"><a href="#application-—" class="headerlink" title="--- application —"></a>--- application —</h3><pre><code>// config.php
base_url :  http://172.16.85.221:1981/
index_url:  /index.php?
</code></pre><h3 id="useage"><a href="#useage" class="headerlink" title="useage:"></a>useage:</h3><p><strong>1.1 on view, normal</strong></p>
<pre><code>&lt;?php echo anchor(&apos;manager/password/reset&apos;, &apos;Password reset&apos;);?&gt;
&lt;a href=&quot;&lt;?php%20echo%20site_url(&apos;manager/AppTranslate&apos;)%20?&gt;&quot;&gt;Translate&lt;/a&gt;
</code></pre><p><strong>1.2 on view, ajax request(javascript block)</strong></p>
<pre><code>$.ajax({
    &apos;method&apos;: &apos;POST&apos;,
    &apos;dataType&apos;: &apos;json&apos;,
    &apos;data&apos;: {&apos;uid&apos;: uid, &apos;uname&apos;: uname},
    &apos;url&apos;: &apos;&lt;?php echo site_url(&apos;manager/UserManager/delete&apos;); ?&gt;&apos;,
    &apos;success&apos;: function (data) {
        if (data &amp;&amp; data.data.status == true) {
            alert(&apos;Selected user&apos;s state already delete&apos;);
        } else {
            alert(&apos;Delete user failed.&apos;);
        }
    },
    &apos;error&apos;: function (err_data){
        alert(&apos;delete failed.&apos;);
        console.log(err_data);
    }
});
</code></pre><p><strong>2.1 on controller</strong></p>
<pre><code>$this-&gt;load-&gt;library(&apos;pagination&apos;);
$config[&apos;base_url&apos;] = &apos;index.php?/manager/ListUser/index&apos;;
$config[&apos;total_rows&apos;] = $this-&gt;users-&gt;get_user_count(&apos;&apos;);
$this-&gt;pagination-&gt;initialize($config);
$page_size = $this-&gt;config-&gt;item(&apos;per_page&apos;);
$pagination_link = $this-&gt;pagination-&gt;create_links();
</code></pre><h3 id="nginx-—"><a href="#nginx-—" class="headerlink" title="--- nginx —"></a>--- nginx —</h3><pre><code>38 server {
39 &gt;---listen 1081 default_server;
40 &gt;---listen [::]:1081 default_server;
41 &gt;---root /home/wwwroot/Maret_API_MGR;
42 
43 &gt;---index index.php index.html;
44 
45 &gt;---server_name _;
46 
47 &gt;---location / {
48         try_files $uri $uri/ /index.php;
49         if (!-e $request_filename) {                                                                                                                                                      
50             rewrite ^/(index.php?/)(.*)([/])$
51             http://172.16.85.221:1981/$2/index.php break;
52         }
53 &gt;---}
54 
55 &gt;---location ~ .php$ {
56 &gt;---&gt;---include snippets/fastcgi-php.conf;
57 &gt;---&gt;---fastcgi_pass unix:/run/php/php7.0-fpm.sock;
58 &gt;---}
59 }
</code></pre>
      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/技术分类/">技术分类</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CodeIginter/">CodeIginter</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ci/">ci</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nginx/">nginx</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-gets-all-files-in-the-directory-with-php" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/28/gets-all-files-in-the-directory-with-php/">PHP 获取目录下的所有文件</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2017/04/28/gets-all-files-in-the-directory-with-php/" class="article-date">
	  <time datetime="2017-04-28T08:00:25.000Z" itemprop="datePublished">四月 28, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="PHP-获取目录下的所有文件"><a href="#PHP-获取目录下的所有文件" class="headerlink" title="PHP 获取目录下的所有文件"></a>PHP 获取目录下的所有文件</h1><p>转载了一篇通过PHP获取指定目录下所有文件/子文件并打印出来的方法，实测可用</p>
<p>运行示例：<br>执行文件在 home 目录下，指定要获取的是 home 下的 Picture 目录（包含子目录）</p>
<p><img src="https://tech.msla.top/wp-content/uploads/2018/04/5902f77ec5d7a.png" alt="20170428_001_e1a5.png" title="20170428_001_e1a5.png"></p>
<h3 id="1-获取目录下文件，不包括子目录"><a href="#1-获取目录下文件，不包括子目录" class="headerlink" title="1. 获取目录下文件，不包括子目录"></a>1. 获取目录下文件，不包括子目录</h3><p><code></code><br>    //获取某目录下所有文件、目录名（不包括子目录下文件、目录名）<br>        $handler = opendir($dir);<br>        while (($filename = readdir($handler)) !== false) {//务必使用!==，防止目录下出现类似文件名“0”等情况<br>            if ($filename != “.” &amp;&amp; $filename != “..”) {<br>                    $files[] = $filename ;<br>               }<br>           }<br>        }<br>        closedir($handler);  </p>
<pre><code>//打印所有文件名  
foreach ($filens as $value) {  
    echo $value.&quot;&quot;;  
}
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">### 2\. 获取目录下所有文件，包括子目录</span><br><span class="line"></span><br><span class="line">注意，最好使用绝对路径，相对路径不能用 &quot;../xxxx/bbb&quot; 或者 &quot;~/aaa/bbb/ccc&quot; 这样的</span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">    function get_allfiles($path,&amp;$files) &#123;</span><br><span class="line">        if(is_dir($path))&#123;</span><br><span class="line">            $dp = dir($path);</span><br><span class="line">            while ($file = $dp -&gt;read())&#123;</span><br><span class="line">                if($file !=&quot;.&quot; &amp;&amp; $file !=&quot;..&quot;)&#123;</span><br><span class="line">                    get_allfiles($path.&quot;/&quot;.$file, $files);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            $dp -&gt;close();</span><br><span class="line">        &#125;</span><br><span class="line">        if(is_file($path))&#123;</span><br><span class="line">            $files[] =  $path;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function get_filenamesbydir($dir)&#123;</span><br><span class="line">        $files =  array();</span><br><span class="line">        get_allfiles($dir,$files);</span><br><span class="line">        return $files;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 路径末尾可以不用放斜线</span><br><span class="line">    $filenames = get_filenamesbydir(&quot;Picture&quot;);</span><br><span class="line">    //打印所有文件名，包括路径</span><br><span class="line">    foreach ($filenames as $value) &#123;</span><br><span class="line">        echo $value.&quot;&quot;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/技术分类/">技术分类</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-nginx-e9-85-8d-e7-bd-aelocation-e6-80-bb-e7-bb-93-e5-8f-8arewrite-e8-a7-84-e5-88-99-e5-86-99-e6-b3-95" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/27/nginx-e9-85-8d-e7-bd-aelocation-e6-80-bb-e7-bb-93-e5-8f-8arewrite-e8-a7-84-e5-88-99-e5-86-99-e6-b3-95/">nginx配置location总结及rewrite规则写法</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2017/04/27/nginx-e9-85-8d-e7-bd-aelocation-e6-80-bb-e7-bb-93-e5-8f-8arewrite-e8-a7-84-e5-88-99-e5-86-99-e6-b3-95/" class="article-date">
	  <time datetime="2017-04-27T07:11:24.000Z" itemprop="datePublished">四月 27, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="1-location正则写法"><a href="#1-location正则写法" class="headerlink" title="1. location正则写法"></a>1. location正则写法</h1><p>一个示例：</p>
<p>location = / { # 精确匹配 / ，主机名后面不能带任何字符串 [ configuration A ] }location / { # 因为所有的地址都以 / 开头，所以这条规则将匹配到所有请求 # 但是正则和最长字符串会优先匹配 [ configuration B ] }location /documents/ { # 匹配任何以 /documents/ 开头的地址，匹配符合以后，还要继续往下搜索 # 只有后面的正则表达式没有匹配到时，这一条才会采用这一条 [ configuration C ] }location ~ /documents/Abc { # 匹配任何以 /documents/Abc 开头的地址，匹配符合以后，还要继续往下搜索 # 只有后面的正则表达式没有匹配到时，这一条才会采用这一条 [ configuration CC ] }location ^~ /images/ { # 匹配任何以 /images/ 开头的地址，匹配符合以后，停止往下搜索正则，采用这一条。 [ configuration D ] } location ~<em> \.(gif|jpg|jpeg)$ { # 匹配所有以 gif,jpg或jpeg 结尾的请求 # 然而，所有请求 /images/ 下的图片会被 config D 处理，因为 ^~ 到达不了这一条正则 [ configuration E ] } location /images/ { # 字符匹配到 /images/，继续往下，会发现 ^~ 存在 [ configuration F ] } location /images/abc { # 最长字符匹配到 /images/abc，继续往下，会发现 ^~ 存在 # F与G的放置顺序是没有关系的 [ configuration G ] } location ~ /images/abc/ { # 只有去掉 config D 才有效：先最长匹配 config G 开头的地址，继续往下搜索，匹配到这一条正则，采用 [ configuration H ] } location ~</em> /js/.*/\.js</p>
<ul>
<li>已<code>=</code>开头表示精确匹配 如 A 中只匹配根目录结尾的请求，后面不能带任何字符串。</li>
<li><code>^~</code> 开头表示uri以某个常规字符串开头，不是正则匹配</li>
<li>~ 开头表示区分大小写的正则匹配;</li>
<li>~* 开头表示不区分大小写的正则匹配</li>
<li>/ 通用匹配, 如果没有其它匹配,任何请求都会匹配到</li>
</ul>
<p>顺序 no优先级： (location =) &gt; (location 完整路径) &gt; (location ^~ 路径) &gt; (location ~,~* 正则顺序) &gt; (location 部分起始路径) &gt; (/) 上面的匹配结果 按照上面的location写法，以下的匹配示例成立：</p>
<ul>
<li>/ -> config A 精确完全匹配，即使/index.html也匹配不了</li>
<li>/downloads/download.html -&gt; config B 匹配B以后，往下没有任何匹配，采用B</li>
<li>/images/1.gif -&gt; configuration D 匹配到F，往下匹配到D，停止往下</li>
<li>/images/abc/def -&gt; config D 最长匹配到G，往下匹配D，停止往下 你可以看到 任何以/images/开头的都会匹配到D并停止，FG写在这里是没有任何意义的，H是永远轮不到的，这里只是为了说明匹配顺序</li>
<li>/documents/document.html -&gt; config C 匹配到C，往下没有任何匹配，采用C</li>
<li>/documents/1.jpg -&gt; configuration E 匹配到C，往下正则匹配到E</li>
<li>/documents/Abc.jpg -&gt; config CC 最长匹配到C，往下正则顺序匹配到CC，不会往下到E</li>
</ul>
<h2 id="实际使用建议"><a href="#实际使用建议" class="headerlink" title="实际使用建议"></a>实际使用建议</h2><p>所以实际使用中，个人觉得至少有三个匹配规则定义，如下： #直接匹配网站根，通过域名访问网站首页比较频繁，使用这个会加速处理，官网如是说。 #这里是直接转发给后端应用服务器了，也可以是一个静态首页 # 第一个必选规则 location = / { proxy_pass <a href="http://tomcat:8080/index" target="_blank" rel="noopener">http://tomcat:8080/index</a> } # 第二个必选规则是处理静态文件请求，这是nginx作为http服务器的强项 # 有两种配置模式，目录匹配或后缀匹配,任选其一或搭配使用 location ^~ /static/ { root /webroot/static/; } location ~* \.(gif|jpg|jpeg|png|css|js|ico)$ { root /webroot/res/; } #第三个规则就是通用规则，用来转发动态请求到后端应用服务器 #非静态文件请求就默认是动态请求，自己根据实际把握 #毕竟目前的一些框架的流行，带.php,.jsp后缀的情况很少了 location / { proxy_pass <a href="http://tomcat:8080/" target="_blank" rel="noopener">http://tomcat:8080/</a> }</p>
<p><a href="http://tengine.taobao.org/book/chapter_02.html" target="_blank" rel="noopener">http://tengine.taobao.org/book/chapter_02.html</a> <a href="http://nginx.org/en/docs/http/ngx_http_rewrite_module.html" target="_blank" rel="noopener">http://nginx.org/en/docs/http/ngx_http_rewrite_module.html</a></p>
<h1 id="2-Rewrite规则"><a href="#2-Rewrite规则" class="headerlink" title="2. Rewrite规则"></a>2. Rewrite规则</h1><p>rewrite功能就是，使用nginx提供的全局变量或自己设置的变量，结合正则表达式和标志位实现url重写以及重定向。rewrite只能放在server{},location{},if{}中，并且只能对域名后边的除去传递的参数外的字符串起作用，例如 <code>http://seanlook.com/a/we/index.php?id=1&amp;u=str</code> 只对/a/we/index.php重写。语法<code>rewrite regex replacement [flag];</code> 如果相对域名或参数字符串起作用，可以使用全局变量匹配，也可以使用proxy_pass反向代理。 表明看rewrite和location功能有点像，都能实现跳转，主要区别在于rewrite是在同一域名内更改获取资源的路径，而location是对一类路径做控制访问或反向代理，可以proxy_pass到其他机器。很多情况下rewrite也会写在location里，它们的执行顺序是：</p>
<ol>
<li>执行server块的rewrite指令</li>
<li>执行location匹配</li>
<li>执行选定的location中的rewrite指令</li>
</ol>
<p>如果其中某步URI被重写，则重新循环执行1-3，直到找到真实存在的文件；循环超过10次，则返回500 Internal Server Error错误。</p>
<h2 id="2-1-flag标志位"><a href="#2-1-flag标志位" class="headerlink" title="2.1 flag标志位"></a>2.1 flag标志位</h2><ul>
<li><code>last</code> : 相当于Apache的[L]标记，表示完成rewrite</li>
<li><code>break</code> : 停止执行当前虚拟主机的后续rewrite指令集</li>
<li><code>redirect</code> : 返回302临时重定向，地址栏会显示跳转后的地址</li>
<li><code>permanent</code> : 返回301永久重定向，地址栏会显示跳转后的地址</li>
</ul>
<p>因为301和302不能简单的只返回状态码，还必须有重定向的URL，这就是return指令无法返回301,302的原因了。这里 last 和 break 区别有点难以理解：</p>
<ol>
<li>last一般写在server和if中，而break一般使用在location中</li>
<li>last不终止<em>重写后</em>的url匹配，即新的url会再从server走一遍匹配流程，而break终止重写后的匹配</li>
<li>break和last都能组织继续执行后面的rewrite指令</li>
</ol>
<h2 id="2-2-if指令与全局变量"><a href="#2-2-if指令与全局变量" class="headerlink" title="2.2 if指令与全局变量"></a>2.2 if指令与全局变量</h2><p><strong>if判断指令</strong> 语法为<code>if(condition){...}</code>，对给定的条件condition进行判断。如果为真，大括号内的rewrite指令将被执行，if条件(conditon)可以是如下任何内容：</p>
<ul>
<li>当表达式只是一个变量时，如果值为空或任何以0开头的字符串都会当做false</li>
<li>直接比较变量和内容时，使用<code>=</code>或<code>!=</code></li>
<li><code>~</code>正则表达式匹配，<code>~*</code>不区分大小写的匹配，<code>!~</code>区分大小写的不匹配</li>
</ul>
<p><code>-f</code>和<code>!-f</code>用来判断是否存在文件 <code>-d</code>和<code>!-d</code>用来判断是否存在目录 <code>-e</code>和<code>!-e</code>用来判断是否存在文件或目录 <code>-x</code>和<code>!-x</code>用来判断文件是否可执行 例如：</p>
<p>if ($http_user_agent ~ MSIE) { rewrite ^(.<em>)$ /msie/$1 break; } //如果UA包含”MSIE”，rewrite请求到/msid/目录下if ($http_cookie ~</em> “id=([^;]+)(?:;|$)”) { set $id $1; } //如果cookie匹配正则，设置变量$id等于正则引用部分if ($request_method = POST) { return 405; } //如果提交方法为POST，则返回状态405（Method not allowed）。return不能返回301,302if ($slow) { limit_rate 10k; } //限速，$slow可以通过 set 指令设置if (!-f $request_filename){ break; proxy_pass <a href="http://127.0.0.1" target="_blank" rel="noopener">http://127.0.0.1</a>; } //如果请求的文件名不存在，则反向代理到localhost 。这里的break也是停止rewrite检查 if ($args ~ post=140){ rewrite ^ <a href="http://example.com/" target="_blank" rel="noopener">http://example.com/</a> permanent; } //如果query string中包含”post=140”，永久重定向到example.com location ~* \.(gif|jpg|png|swf|flv)$ { valid_referers none blocked <a href="http://www.jefflei.com" target="_blank" rel="noopener">www.jefflei.com</a> <a href="http://www.leizhenfang.com" target="_blank" rel="noopener">www.leizhenfang.com</a>; if ($invalid_referer) { return 404; } //防盗链 }</p>
<p><strong>全局变量</strong> 下面是可以用作if判断的全局变量</p>
<ul>
<li><code>$args</code> ： #这个变量等于请求行中的参数，同<code>$query_string</code></li>
<li><code>$content_length</code> ： 请求头中的Content-length字段。</li>
<li><code>$content_type</code> ： 请求头中的Content-Type字段。</li>
<li><code>$document_root</code> ： 当前请求在root指令中指定的值。</li>
<li><code>$host</code> ： 请求主机头字段，否则为服务器名称。</li>
<li><code>$http_user_agent</code> ： 客户端agent信息</li>
<li><code>$http_cookie</code> ： 客户端cookie信息</li>
<li><code>$limit_rate</code> ： 这个变量可以限制连接速率。</li>
<li><code>$request_method</code> ： 客户端请求的动作，通常为GET或POST。</li>
<li><code>$remote_addr</code> ： 客户端的IP地址。</li>
<li><code>$remote_port</code> ： 客户端的端口。</li>
<li><code>$remote_user</code> ： 已经经过Auth Basic Module验证的用户名。</li>
<li><code>$request_filename</code> ： 当前请求的文件路径，由root或alias指令与URI请求生成。</li>
<li><code>$scheme</code> ： HTTP方法（如http，https）。</li>
<li><code>$server_protocol</code> ： 请求使用的协议，通常是HTTP/1.0或HTTP/1.1。</li>
<li><code>$server_addr</code> ： 服务器地址，在完成一次系统调用后可以确定这个值。</li>
<li><code>$server_name</code> ： 服务器名称。</li>
<li><code>$server_port</code> ： 请求到达服务器的端口号。</li>
<li><code>$request_uri</code> ： 包含请求参数的原始URI，不包含主机名，如：”/foo/bar.php?arg=baz”。</li>
<li><code>$uri</code> ： 不带请求参数的当前URI，$uri不包含主机名，如”/foo/bar.html”。</li>
<li><code>$document_uri</code> ： 与$uri相同。</li>
</ul>
<p>例：<code>http://localhost:88/test1/test2/test.php</code> $host：localhost $server_port：88 $request_uri：<a href="http://localhost:88/test1/test2/test.php" target="_blank" rel="noopener">http://localhost:88/test1/test2/test.php</a> $document_uri：/test1/test2/test.php $document_root：/var/www/html $request_filename：/var/www/html/test1/test2/test.php</p>
<h2 id="2-3-常用正则"><a href="#2-3-常用正则" class="headerlink" title="2.3 常用正则"></a>2.3 常用正则</h2><ul>
<li><code>.</code> ： 匹配除换行符以外的任意字符</li>
<li><code>?</code> ： 重复0次或1次</li>
<li><code>+</code> ： 重复1次或更多次</li>
<li><code>*</code> ： 重复0次或更多次</li>
<li><code>\d</code> ：匹配数字</li>
<li><code>^</code> ： 匹配字符串的开始</li>
<li><code>$</code> ： 匹配字符串的介绍</li>
<li><code>{n}</code> ： 重复n次</li>
<li><code>{n,}</code> ： 重复n次或更多次</li>
<li><code>[c]</code> ： 匹配单个字符c</li>
<li><code>[a-z]</code> ： 匹配a-z小写字母的任意一个</li>
</ul>
<p>小括号<code>()</code>之间匹配的内容，可以在后面通过<code>$1</code>来引用，<code>$2</code>表示的是前面第二个<code>()</code>里的内容。正则里面容易让人困惑的是<code>\</code>转义特殊字符。</p>
<h2 id="2-4-rewrite实例"><a href="#2-4-rewrite实例" class="headerlink" title="2.4 rewrite实例"></a>2.4 rewrite实例</h2><p>_例1_：</p>
<p>http { # 定义image日志格式 log_format imagelog ‘[$time_local] ‘ $image_file ‘ ‘ $image_type ‘ ‘ $body_bytes_sent ‘ ‘ $status; # 开启重写日志 rewrite_log on;server { root /home/www;location / { # 重写规则信息 error_log logs/rewrite.log notice; # 注意这里要用‘’单引号引起来，避免{} rewrite ‘^/images/([a-z]{2})/([a-z0-9]{5})/(.*)\.(png|jpg|gif)$’ /data?file=$3.$4; # 注意不能在上面这条规则后面加上“last”参数，否则下面的set指令不会执行 set $image_file $3; set $image_type $4; }location /data { # 指定针对图片的日志格式，来分析图片类型和大小 access_log logs/images.log mian; root /data/images; # 应用前面定义的变量。判断首先文件在不在，不在再判断目录在不在，如果还不在就跳转到最后一个url里 try_files /$arg_file /image404.html; } location = /image404.html { # 图片不存在返回特定的信息 return 404 “image not found\n”; } }</p>
<p>对形如<code>/images/ef/uh7b3/test.png</code>的请求，重写到<code>/data?file=test.png</code>，于是匹配到<code>location /data</code>，先看<code>/data/images/test.png</code>文件存不存在，如果存在则正常响应，如果不存在则重写tryfiles到新的image404 location，直接返回404状态码。 _例2_：</p>
<p>1</p>
<p>rewrite ^/images/(.*)_(\d+)x(\d+)\.(png|jpg|gif)$ /resizer/$1.$4?width=$2&amp;height=$3? last;</p>
<p>对形如<code>/images/bla_500x400.jpg</code>的文件请求，重写到<code>/resizer/bla.jpg?width=500&amp;height=400</code>地址，并会继续尝试匹配location。 _例3_： 见 <a href="http://seanlook.com/2015/05/28/nginx-ssl" target="_blank" rel="noopener">ssl部分页面加密</a> 。</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/技术分类/">技术分类</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nginx/">nginx</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-glusterfs-e8-b0-83-e7-a0-94" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/21/glusterfs-e8-b0-83-e7-a0-94/">GlusterFS 调研</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2017/04/21/glusterfs-e8-b0-83-e7-a0-94/" class="article-date">
	  <time datetime="2017-04-21T10:55:19.000Z" itemprop="datePublished">四月 21, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>与Hadoop HDFS不同的是：GlusterFS使用了弹性哈希算法来定位文件存储的位置。 由于使用了弹性哈希算法，GlusterFS不需要专门的Meta-Data Server来保存元数据，因此可以避免因为元数据服务器宕机导致的整个集群不可用。也正是因为不需要元数据服务器，所以GlusterFS在多个挂载点同时进行数据读写的时候，其整体性能很突出。</p>
<h4 id="在GlusterFS-3-3版本中增加的新功能包括"><a href="#在GlusterFS-3-3版本中增加的新功能包括" class="headerlink" title="在GlusterFS 3.3版本中增加的新功能包括"></a>在GlusterFS 3.3版本中增加的新功能包括</h4><ol>
<li>统一的文件和对象存储：GlusterFS实现了OpenStack里的对象存储API提供同步读取和写入文件或对象的数据的访问。</li>
<li>HDFS兼容： 使Hadoop的管理员在GlusterFS的非结构化数据上运行MapReduce任务，并可以通过常用的工具和shell脚本访问GlusterFS上的数据。</li>
<li>主动自我修复：GlusterFS卷可以在宕机恢复之后自动从备份服务器上恢复数据。</li>
<li>Granular锁：允许在对大文件的自我修复过程中访问数据，这个功能对于把GlusterFS作为虚拟机磁盘镜像存储服务器时及其重要。</li>
<li>改进的复制策略：系统在写入数据时，只有当用户指定的备份数量的写入操作都完成时才返回。该功能为用户提供了在数据安全性和性能之间做权衡的能力。</li>
</ol>
<hr>
<h4 id="CentOS7-配置："><a href="#CentOS7-配置：" class="headerlink" title="CentOS7 配置："></a>CentOS7 配置：</h4><p><a href="https://wiki.centos.org/zh/HowTos/GlusterFSonCentOS" target="_blank" rel="noopener">https://wiki.centos.org/zh/HowTos/GlusterFSonCentOS</a>  </p>
<hr>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/技术分类/">技术分类</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GlusterFS/">GlusterFS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/文件存储/">文件存储</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-yaf-e4-bd-bf-e7-94-a8-e6-b3-a8-e6-84-8f-e4-ba-8b-e9-a1-b9" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/19/yaf-e4-bd-bf-e7-94-a8-e6-b3-a8-e6-84-8f-e4-ba-8b-e9-a1-b9/">Yaf 使用注意事项</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2017/04/19/yaf-e4-bd-bf-e7-94-a8-e6-b3-a8-e6-84-8f-e4-ba-8b-e9-a1-b9/" class="article-date">
	  <time datetime="2017-04-19T01:13:14.000Z" itemprop="datePublished">四月 19, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="配置文件格式"><a href="#配置文件格式" class="headerlink" title="配置文件格式"></a>配置文件格式</h3><p>需要仔细校对，第二个section中的<code>product</code>是和 php.ini 中的 <strong><code>yaf.envrion</code></strong> 配置项的值对应。并且common 节一定要继承自 common section，否则需要把common section 的配置写到 product 中。 如果 php.ini 中 yaf.use_namespace:设置为1的话，表示开启了命名空间（默认不开启），则在读取配置文件时，也要相应的在前面加上命名空间的名称（比如Yaf_Application要变成YafApplication），否则会提示 <code>Class &#39;Yaf_Application&#39; not found</code></p>
<pre><code>[ps2id id=&apos;configure_struct&apos; target=&apos;&apos;/]
[common]
application.directory = APPLICATION_PATH  &quot;/application&quot;
application.dispatcher.catchException = TRUE

[dev : common]
database.dsn = &apos;mysql:host=127.0.0.1;dbname=test&apos;
database.host = &apos;localhost&apos;
database.user = &apos;db_user&apos;
database.pwd = &apos;db_password&apos;
</code></pre><h3 id="配置文件调用示例"><a href="#配置文件调用示例" class="headerlink" title="配置文件调用示例"></a>配置文件调用示例</h3><p>Model 用于提供数据访问的各种方法，这里示例是在 /application/models/User.php 下面</p>
<pre><code>private $conf = null;
function __construct()
{
    $this-&gt;conf = Yaf_Application::app()-&gt;getConfig();
}

/**
 * List 10 Users
 */
function listUser(){
    $arr_users = array();

    $dsn = $this-&gt;conf-&gt;database-&gt;dsn;
    $db_user = $this-&gt;conf-&gt;database-&gt;user;
    $db_pwd = $this-&gt;conf-&gt;database-&gt;pwd;
    $sql = &apos;select email,password from users limit 10&apos;;
    try{
        $pdo = new PDO($dsn,$db_user,$db_pwd);
        if ($pdo){
            $stmt = $pdo-&gt;prepare($sql);
            $stmt-&gt;execute();
            $arr_data = $stmt-&gt;fetchAll(PDO::FETCH_ASSOC);
            foreach ($arr_data as $datum){
                $arr_users[] = array(
                    &apos;email&apos;=&gt;$datum[&apos;email&apos;],
                    &apos;pwd&apos;=&gt;$datum[&apos;pwd&apos;],
                );
            }
        }
    }catch (PDOException $exception){
        throw  new PDOException(&apos;PDO Exception: &apos; . $exception-&gt;getMessage());
    }catch (Exception $exception){
        throw new Exception(&apos;Unknowing Exception: &apos; . $exception-&gt;getMessage());
    }

    return $arr_users;
}
</code></pre><hr>
<h3 id="调用外部-第三方类库"><a href="#调用外部-第三方类库" class="headerlink" title="调用外部/第三方类库"></a>调用外部/第三方类库</h3><p><strong>示例一</strong></p>
<pre><code>// 导入： yafoo/application/Bootstrap.php
    public function _initLoader($dispatcher){
        $loader = Yaf_Loader::getInstance();
        $loader::import(APPLICATION_PATH . &apos;/application/library/Requests/Requests.php&apos;);
    }

    // 调用时： 
    $response = Requests::get(&apos;http://www.baidu.com/?s=&apos;.$key);
</code></pre><p><strong>示例二</strong></p>
<pre><code>// Boostrap.php
$loader::import(APPLICATION_PATH . &apos;/application/library/Raven/Client.php&apos;);
Raven_Autoloader::register();

// 调用时
function someAction(){
    // code ...
    // code ....
    try{
        // some code ...
    } catch (PDOException $exception) {
        $sentry_client = new Raven_Client($sentry_url);
        $sentry_client-&gt;captureException($exception,array(
            &apos;extra&apos;=&gt;array(
                &apos;php_version&apos;=&gt;phpversion(),
                &apos;environment&apos;=&gt;Yaf_Application::app()-&gt;environ(),
            )
        ));

        throw  new PDOException(&apos;PDO Exception: &apos; . $exception-&gt;getMessage());
    }
}
</code></pre><hr>
<p><strong>如何设置多个models路径</strong></p>
<blockquote>
<p>models, controllers都支持下划线分割, 比如, 如果你是多个modules的不同model, 那么可以命名为 A_B_CModel 那么就会在models目录下的A目录的B目录里面找C</p>
</blockquote>
<h2 id="yaf控制器使用"><a href="#yaf控制器使用" class="headerlink" title="yaf控制器使用"></a>yaf控制器使用</h2><p>控制器方法 - 对用户可见的方法(即用户可以直接访问的方法)需要加上Action后缀 - 初始化类的方法为init，不是__construct</p>
<h3 id="独立文件定义操作-方法"><a href="#独立文件定义操作-方法" class="headerlink" title="独立文件定义操作(方法)"></a>独立文件定义操作(方法)</h3><p><strong>1、作用：为了分解大的控制器，让代码更加清晰</strong> <strong>2、使用方法</strong> <strong>（1）在控制器中绑定操作(即将操作绑定到某个操作类上)</strong></p>
<pre><code>class TestController extends YafController_Abstract
{
    public $actions = array(
        &apos;index&apos;=&gt;&apos;actions/index.php&apos;,
        &apos;add&apos;=&gt;&apos;actions/add.php&apos;,
        &apos;detail&apos;=&gt;&apos;actions/detail.php&apos;  
    );
}
</code></pre><p><strong>（2）定义操作类</strong></p>
<pre><code>class DetailAction extends YafAction_Abstract
{
    public function execute()
    {
        var_dump($this-&gt;getRequest()-&gt;getParam(&apos;id&apos;));
    }
}
</code></pre><p><strong>3、定义操作类</strong></p>
<ul>
<li>- 操作类位置：一般在application/actions下面，如detail.php(application/actions/detail.php)</li>
<li>- 操作类命名：必须以Action为后缀，如DetailAction</li>
<li>- 继承：继承自YafAction_abstract</li>
<li>- 必须实现的方法：execute,因为其父类YafAction_abstract是一个抽象类，必须实现抽象方法execute</li>
<li>- 可以使用的父类方法：不仅可以使用YafAction_abstract的方法，还可以继承YafController_Abstract的方法(因为YafAction_abstract继承自YafController_Abstract)</li>
</ul>
<h3 id="三、控制器基类YafController-Abstract"><a href="#三、控制器基类YafController-Abstract" class="headerlink" title="三、控制器基类YafController_Abstract"></a>三、控制器基类YafController_Abstract</h3><p><strong>1、初始化操作</strong></p>
<ul>
<li>- init:初始化操作(如初始化实例变量，在yaf中替代__construct的功能)</li>
<li>- initView:初始化视图</li>
</ul>
<p><strong>2、视图相关操作</strong></p>
<ul>
<li>(1)getViewpath:获取视图文件目录，默认在application/views下面，也可以通过setViewpath设置修改</li>
<li>(2)setViewpath:设置视图文件目录</li>
<li>(3)getView:获取当前视图对象</li>
<li>(4)display:渲染一个视图模板, 并直接输出给请求端</li>
<li>(5)render:渲染视图模板, 得到渲染结果</li>
</ul>
<p><strong>3、获取请求与响应对象</strong></p>
<ul>
<li>- getRequest:获取当前请求对象，那么它就可以调用request对象所有的方法</li>
<li><p>- getResponse:获取当前响应对象，那么它就可以调用response对象所有的方法</p>
<p>class TestController extends YafController_Abstract</p>
<pre><code>{
    public function testAction()
    {
        $id = $this-&gt;getRequest()-&gt;getParam(&apos;id&apos;);
        $response = $this-&gt;getResponse();
        $response-&gt;setHeader(&apos;content-type&apos;, &apos;application/json&apos;);
        $json = json_encode(array(&apos;id&apos;=&gt;$id, &apos;message&apos;=&gt;&apos;success&apos;));
        $response-&gt;setBody($json);
        //$response-&gt;response();
    }
}
</code></pre></li>
</ul>
<p>注：在浏览器中输入：<a href="http://www.domain.com/test/test/id/123，即可输出：{&quot;id&quot;:&quot;123&quot;,&quot;message&quot;:&quot;success&quot;}" target="_blank" rel="noopener">http://www.domain.com/test/test/id/123，即可输出：{&quot;id&quot;:&quot;123&quot;,&quot;message&quot;:&quot;success&quot;}</a> <strong>4、获取当前请求相关的参数</strong> - getModuleName:获取当前模块名(如果想获取当前控制器名或方法名，可以使用request对象来获取) 获取当前路由参数的简写方式：</p>
<pre><code>public function testAction($name, $id)
{
        echo $name;        //相当于echo $this-&gt;getRequest()-&gt;getParam(&apos;name&apos;);
        echo $id;          //相当于echo $this-&gt;getRequest()-&gt;getParam(&apos;id&apos;);
}
</code></pre><p>在浏览器中输入：<a href="http://www.doamin.com/test/test/id/123/name/shixinke" target="_blank" rel="noopener">http://www.doamin.com/test/test/id/123/name/shixinke</a> 得到输出内容：shixinke 123 <strong>5、页面跳转</strong> - forword : 跳转到某个控制器的某个方法，不会立即跳转，会继续执行它后面的内容 - redirect : 跳转到一个uri 例如：登录的权限控制 <strong>(1)使用forward</strong></p>
<pre><code>class IndexController extends YafController_Abstract
{
    public function indexAction(){   
         $logined = $_SESSION[&quot;userId&quot;];
         if (!$logined) {
             $this-&gt;forward(&quot;login&quot;, array(&quot;from&quot; =&gt; &quot;Index&quot;)); // 跳转到当前模块的login操作
             return FALSE;  //立即返回就不会执行后面的内容了
         }

         //显示内容
    }

    public function loginAction() {
         echo &quot;login, redirected from &quot;, $this-&gt;_request-&gt;getParam(&quot;from&quot;) , &quot; action&quot;;
    }
}
?&gt;
</code></pre><p>注:如果要跳转到其他模块，$this-&gt;forward(‘admin’, ‘login’, ‘index’, array(‘from’=&gt;’index’)); //跳转到admin模块的login控制器的index方法 <strong>(2)使用redirect</strong></p>
<pre><code>public function IndexAction()
{
    $logined = $_SESSION[&apos;userId&apos;];
    if (!$logined) {
    $this-&gt;redirect(&apos;http://www.domain.com/admin/login/index&apos;)); // 跳转到http://www.domain.com/admin/login/index这个地址
    return FALSE;  //立即返回就不会执行后面的内容了
    }

}
</code></pre><h3 id="四、错误处理"><a href="#四、错误处理" class="headerlink" title="四、错误处理"></a>四、错误处理</h3><p><strong>1、通过ErrorController这个控制器来捕获异常与错误</strong> 首先得在启动文件中开启异常捕获：</p>
<pre><code>YafDispatcher::getInstance()-&gt;catchException(true);
</code></pre><p>错误控制器：</p>
<pre><code>    class ErrorController extends YafController_Abstract
    {
        /**
         * 也可通过$request-&gt;getException()获取到发生的异常
         */
        public function errorAction($exception)
        {
            $constArr = array(
                YAFERRNOTFOUNDMODULE,
                YAFERRNOTFOUNDCONTROLLER,
                YAFERRDISPATCH_FAILED,
                YAFERRNOTFOUNDACTION,
                YAFERRNOTFOUNDVIEW
            );
            $err = $exception-&gt;getCode();
            if (in_array($err, $constArr)) {
                $code = 404;
                $message = &apos;请求的页面不存在&apos;;
            } else {
                $code = 500;
                $message = &apos;系统出错&apos;;
            }
            if (ENV == &apos;DEV&apos;) {
                $message = $exception-&gt;getMessage();
            }
            //记录日志
            //ajax输出或显示错误模板
            $this-&gt;getView()-&gt;assign(&apos;message&apos;, $message);
        }
    }
configure_struct
</code></pre><p><strong>2、通过YafDispatcher的setErrorHandler来捕获错误与异常</strong> 在启动文件中定义一个appErrorHandler的函数，并在_initRoute()中添加相应的捕获代码</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/技术分类/">技术分类</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/yaf/">yaf</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-e4-bd-bf-e7-94-a8-xdebug-e8-b0-83-e8-af-95php-e7-9a-84-e6-8a-80-e5-b7-a7" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/17/e4-bd-bf-e7-94-a8-xdebug-e8-b0-83-e8-af-95php-e7-9a-84-e6-8a-80-e5-b7-a7/">使用 xdebug调试PHP的技巧</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2017/04/17/e4-bd-bf-e7-94-a8-xdebug-e8-b0-83-e8-af-95php-e7-9a-84-e6-8a-80-e5-b7-a7/" class="article-date">
	  <time datetime="2017-04-17T12:40:28.000Z" itemprop="datePublished">四月 17, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>作者：许胜斌 链接：<a href="https://www.zhihu.com/question/20348619/answer/101893104" target="_blank" rel="noopener">https://www.zhihu.com/question/20348619/answer/101893104</a> 来源：知乎 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
<p>我目前遇到的最让我称赞的debug方式是：<strong>xdebug</strong>的</p>
<pre><code>xdebug_start_trace();
/* 业务代码     */
xdebug_stop_trace();
</code></pre><p>他解决了我长久以来一个代码调试问题：比如有以下几个场景： 1、一个有几百行的函数，里面有很多return，现在函数异常返回了，但是我不知道是从哪一行返回的，这时候呢，我一般的做法都是每一行echo();die();太费事了。 2、接触一个新的框架，代码执行出现异常，怎么办呢，肯定也是一行一行的echo();die(); 3、想学习一个新框架，想知道代码的执行轨迹：执行了哪些类、调用了哪些类的方法，等等。 现在呢，xdebug的代码跟踪，能帮我们轻松解决上面的问题。 <strong>xdebug的安装</strong> （网上我看到了很多的都是在说xdebug、phpstorm、chrome咋配合起来远程调试，搞得大家好像觉得xdebug用起来那么费事，那么高级，其实没必要）： 1、安装php xdebug扩展（不再细说） 2、配置：这里只讲代码跟踪相关的配置：</p>
<pre><code>cat /etc/php.d/xdebug.ini
extension=/usr/lib64/php/modules/xdebug.so 
;代码跟踪日志文件位置,注意要先新建这个traces目录，并设置777
xdebug.trace_output_dir = /tmp/traces
;代码跟踪日志文件格式 
xdebug.trace_output_name = trace.%c.%p
;trace中显示函数的参数值，这个很有用，待会细说
xdebug.collect_params = 4
xdebug.collect_includes = On
xdebug.collect_return = On
xdebug.show_mem_delta = On
</code></pre><p>  安装好之后，代码执行明细(trace)，就存放在/tmp/traces目录下了:   <img src="https://tech.msla.top/wp-content/uploads/2018/04/d2006b7fc37cc5a97e300655c797e90b_b.png" alt=""> 我截取一段trace日志，大家看下，就能感知到这个用法的方便了： 1、显示了参数的值：就这一点，我想就会节省我们phper很多的调试时间（默认不显示参数值，只显示调用的函数。需要添加xdebug.collect_params这个配置） <img src="https://tech.msla.top/wp-content/uploads/2018/04/972289d2659f965081cc0ac2e8a8de02_b.png" alt=""> 1、显示了参数的值：就这一点，我想就会节省我们phper很多的调试时间（默认不显示参数值，只显示调用的函数。需要添加xdebug.collect_params这个配置） 2、显示了代码的执行轨迹。类似于c语言的单步调试吧。 就这些了，反正用了xdebug，我是觉得debug的时候节省了大量时间，分享给大家，希望对你们也有帮助。 ps：如果大家都xdebug的安装有困惑，可以参考<a href="https://link.zhihu.com/?target=http%3A//www.ibm.com/developerworks/cn/opensource/os-php-xdebug/index.html" target="_blank" rel="noopener">http://www.ibm.com/developerworks/cn/opensource/os-php-xdebug/index.html</a></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/技术分类/">技术分类</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/debug/">debug</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/调试/">调试</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-e5-a6-82-e4-bd-95-e4-bc-98-e9-9b-85-e7-9a-84-e8-be-93-e5-87-baphp-e8-b0-83-e8-af-95-e4-bf-a1-e6-81-af" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/17/e5-a6-82-e4-bd-95-e4-bc-98-e9-9b-85-e7-9a-84-e8-be-93-e5-87-baphp-e8-b0-83-e8-af-95-e4-bf-a1-e6-81-af/">如何优雅的输出PHP调试信息</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2017/04/17/e5-a6-82-e4-bd-95-e4-bc-98-e9-9b-85-e7-9a-84-e8-be-93-e5-87-baphp-e8-b0-83-e8-af-95-e4-bf-a1-e6-81-af/" class="article-date">
	  <time datetime="2017-04-17T12:38:52.000Z" itemprop="datePublished">四月 17, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="如何优雅的输出PHP调试信息"><a href="#如何优雅的输出PHP调试信息" class="headerlink" title="如何优雅的输出PHP调试信息"></a><a href="http://www.cnblogs.com/gidot/p/4307709.html" target="_blank" rel="noopener">如何优雅的输出PHP调试信息</a></h2><p>经常因为出现紧急bug而被老板骂的同事，为了更快的修复而直接利用线上的错误环境现场debug，并直接在页面上echo和dump。结果被老板发现了，又是一通臭骂。那么有没有什么办法更优雅的输出PHP调试信息呢？ 这里提供一个方案：利用浏览器调试模式的Console 1，先定义一个php函数：</p>
<p><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码"></p>
<p> 1 function console($log=’’)<br> 2 {<br> 3     switch (empty($log)) {<br> 4         case False:<br> 5             $out = json_encode($log);<br> 6             $GLOBALS[‘console’] .= ‘console.log(‘.$out.’);’;<br> 7             break;<br> 8<br> 9         default:<br>10             echo ‘<script type="text/javascript">‘.$GLOBALS[‘console’].’</script>‘;<br>11     }<br>12 }</p>
<p><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码"></p>
<pre><code>2，在需要调试的地方直接调用它，递交的参数可以是字符串，也可以是数组。 ![](https://tech.msla.top/wp-content/uploads/2018/04/012220393931537.png)   3，在适当的位置调用无参数的console，用来输出调试信息，比如各类php框架入口文件的最底部 ![](https://tech.msla.top/wp-content/uploads/2018/04/012221208472406.png)   4，打开浏览器（比如chrome），载入页面后进入调试模式（比如按F12键），点击Console，你会发现所有数据都在这里等着你查阅。 ![](https://tech.msla.top/wp-content/uploads/2018/04/012221469725658-1.png)   5，其他用途 优秀的PHP开源框架ThinkPHP提供了输出运行状态的功能，你可以通过运行状态来了解某个页面在后台处理了多长时间。但是，很多人都注意到了，它是不准确的。 下面我们试着用刚刚加进来的自定义函数console在浏览器中输出真正的运行时间。 所有工作都在入口文件中完成： ![](https://tech.msla.top/wp-content/uploads/2018/04/012222279878126.png) 在所有代码的最开头，定义变量$s=microtime(true); 在console();的上面再增加console(&apos;exetime:&apos;.round(microtime(true)-$s,4)); 好了，我们来看看真正的运行时间吧： ![](https://tech.msla.top/wp-content/uploads/2018/04/012222584566118.png)   这个课题就这么简单愉快的解决了。 PS：因为这个函数用到了json来输出数组，所以要求编码为UTF-8，如果使用其它编码可能会出现未知问题，需要留意。
</code></pre>
      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/大前端！/">大前端！</a>, <a class="article-category-link" href="/categories/大前端！/技术分类/">技术分类</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/debug/">debug</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/调试/">调试</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-mongodb-e4-ba-bf-e7-ba-a7-e6-95-b0-e6-8d-ae-e9-87-8f-e7-9a-84-e6-80-a7-e8-83-bd-e6-b5-8b-e8-af-95" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/17/mongodb-e4-ba-bf-e7-ba-a7-e6-95-b0-e6-8d-ae-e9-87-8f-e7-9a-84-e6-80-a7-e8-83-bd-e6-b5-8b-e8-af-95/">Mongodb亿级数据量的性能测试</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2017/04/17/mongodb-e4-ba-bf-e7-ba-a7-e6-95-b0-e6-8d-ae-e9-87-8f-e7-9a-84-e6-80-a7-e8-83-bd-e6-b5-8b-e8-af-95/" class="article-date">
	  <time datetime="2017-04-17T05:41:34.000Z" itemprop="datePublished">四月 17, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>进行了一下Mongodb亿级数据量的性能测试，分别测试如下几个项目：</p>
<p> （所有插入都是单线程进行，所有读取都是多线程进行）</p>
<p>1） 普通插入性能 （插入的数据每条大约在1KB左右） 2） 批量插入性能 （使用的是官方C#客户端的InsertBatch），这个测的是批量插入性能能有多少提高 3） 安全插入功能 （确保插入成功，使用的是SafeMode.True开关），这个测的是安全插入性能会差多少 4） 查询一个索引后的数字列，返回10条记录（也就是10KB）的性能，这个测的是索引查询的性能 5） 查询两个索引后的数字列，返回10条记录（每条记录只返回20字节左右的2个小字段）的性能，这个测的是返回小数据量以及多一个查询条件对性能的影响 6） 查询一个索引后的数字列，按照另一个索引的日期字段排序（索引建立的时候是倒序，排序也是倒序），并且Skip100条记录后返回10条记录的性能，这个测的是Skip和Order对性能的影响 7） 查询100条记录（也就是100KB）的性能（没有排序，没有条件），这个测的是大数据量的查询结果对性能的影响 8） 统计随着测试的进行，总磁盘占用，索引磁盘占用以及数据磁盘占用的数量 并且每一种测试都使用单进程的Mongodb和同一台服务器开三个Mongodb进程作为Sharding（每一个进程大概只能用7GB左右的内存）两种方案 其实对于Sharding，虽然是一台机器放3个进程，但是在查询的时候每一个并行进程查询部分数据，再有运行于另外一个机器的mongos来汇总数据，理论上来说在某些情况下性能会有点提高 基于以上的种种假设，猜测某些情况性能会下降，某些情况性能会提高，那么来看一下最后的测试结果怎么样？ 备注：测试的存储服务器是 E5620  @ 2.40GHz，24GB内存，CentOs操作系统，打压机器是E5504 @ 2.0GHz，4GB内存，Windows Server 2003操作系统，两者千兆网卡直连。 <img src="https://tech.msla.top/wp-content/uploads/2018/04/mongodb_erformance-462x1024.png" alt="" title="mongodb_erformance"> 从这个测试可以看出，对于单进程的方式： 1） Mongodb的非安全插入方式，在一开始插入性能是非常高的，但是在达到了两千万条数据之后性能骤减，这个时候恰巧是服务器24G内存基本占满的时候（随着测试的进行mongodb不断占据内存，一直到操作系统的内存全部占满），也就是说Mongodb的内存映射方式，使得数据全部在内存中的时候速度飞快，当部分数据需要换出到磁盘上之后，性能下降很厉害。（这个性能其实也不算太差，因为我们对三个列的数据做了索引，即使在内存满了之后每秒也能插入2MB的数据，在一开始更是每秒插入25MB数据）。Foursquare其实也是把Mongodb当作带持久化的内存数据库使用的，只是在查不到达到内存瓶颈的时候Sharding没处理好。 2） 对于批量插入功能，其实是一次提交一批数据，但是相比一次一条插入性能并没有提高多少，一来是因为网络带宽已经成为了瓶颈，二来我想写锁也会是一个原因。 3） 对于安全插入功能，相对来说比较稳定，不会波动很大，我想可能是因为安全插入是确保数据直接持久化到磁盘的，而不是插入内存就完事。 4） 对于一列条件的查询，性能一直比较稳定，别小看，每秒能有8000-9000的查询次数，每次返回10KB，相当于每秒查询80MB数据，而且数据库记录是2亿之后还能维持这个水平，性能惊人。 5） 对于二列条件返回小数据的查询，总体上性能会比4）好一点，可能返回的数据量小对性能提高比较大，但是相对来说性能波动也厉害一点，可能多了一个条件就多了一个从磁盘换页的机会。 6） 对于一列数据外加Sort和Skip的查询，在数据量大了之后性能明显就变差了（此时是索引数据量超过内存大小的时候，不知道是否有联系），我猜想是Skip比较消耗性能，不过和4）相比性能也不是差距特别大。 7） 对于返回大数据的查询，一秒瓶颈也有800次左右，也就是80M数据，这就进一步说明了在有索引的情况下，顺序查询和按条件搜索性能是相差无几的，这个时候是IO和网络的瓶颈。 8） 在整个过程中索引占的数据量已经占到了总数据量的相当大比例，在达到1亿4千万数据量的时候，光索引就可以占据整个内存，此时查询性能还是非常高，插入性能也不算太差，mongodb的性能确实很牛。 那么在来看看Sharding模式有什么亮点： 1） 非安全插入和单进程的配置一样，在内存满了之后性能急剧下降。安全插入性能和单进程相比慢不少，但是非常稳定。 2） 对于一个条件和两个条件的查询，性能都比较稳定，但条件查询性能相当于单进程的一半，但是在多条件下有的时候甚至会比单进程高一点。我想这可能是某些时候数据块位于两个Sharding，这样Mongos会并行在两个Sharding查询，然后在把数据进行合并汇总，由于查询返回的数据量小，网络不太可能成为瓶颈了，使得Sharding才有出头的机会。 3） 对于Order和Skip的查询，Sharding方式的差距就出来了，我想主要性能损失可能在Order，因为我们并没有按照排序字段作为Sharding的Key，使用的是_id作为Key，这样排序就比较难进行。 4） 对于返回大数据量的查询，Sharding方式其实和单进程差距不是很大，我想数据的转发可能是一个性能损耗的原因（虽然mongos位于打压机本机，但是数据始终是转手了一次）。 5） 对于磁盘空间的占用，两者其实是差不多的，其中的一些差距可能是因为多个进程都会多分配一点空间，加起来有的时候会比单进程多占用点磁盘（而那些占用比单进程少的地方其实是开始的编码错误，把实际数据大小和磁盘文件占用大小搞错了）。 测试最后的各个Sharding分布情况如下：</p>
<pre><code>{
    &quot;sharded&quot;:true,
    &quot;ns&quot;:&quot;testdb.test&quot;,
    &quot;count&quot;:209766143,
    &quot;size&quot;:214800530672,
    &quot;avgObjSize&quot;:1024.0000011441311,
    &quot;storageSize&quot;:222462757776,
    &quot;nindexes&quot;:4,
    &quot;nchunks&quot;:823,
    &quot;shards&quot;:{
        &quot;shard0000&quot;:{
            &quot;ns&quot;:&quot;testdb.test&quot;,
            &quot;count&quot;:69474248,
            &quot;size&quot;:71141630032,
            &quot;avgObjSize&quot;:1024.0000011515058,
            &quot;storageSize&quot;:74154252592,
            &quot;numExtents&quot;:65,
            &quot;nindexes&quot;:4,
            &quot;lastExtentSize&quot;:2146426864,
            &quot;paddingFactor&quot;:1,
            &quot;flags&quot;:1,
            &quot;totalIndexSize&quot;:11294125824,
            &quot;indexSizes&quot;:{
                &quot;_id_&quot;:2928157632,
                &quot;Number_1&quot;:2832745408,
                &quot;Number1_1&quot;:2833974208,
                &quot;Date_-1&quot;:2699248576
            },
            &quot;ok&quot;:1
        },
        &quot;shard0001&quot;:{
            &quot;ns&quot;:&quot;testdb.test&quot;,
            &quot;count&quot;:70446092,
            &quot;size&quot;:72136798288,
            &quot;avgObjSize&quot;:1024.00000113562,
            &quot;storageSize&quot;:74154252592,
            &quot;numExtents&quot;:65,
            &quot;nindexes&quot;:4,
            &quot;lastExtentSize&quot;:2146426864,
            &quot;paddingFactor&quot;:1,
            &quot;flags&quot;:1,
            &quot;totalIndexSize&quot;:11394068224,
            &quot;indexSizes&quot;:{
                &quot;_id_&quot;:2969355200,
                &quot;Number_1&quot;:2826453952,
                &quot;Number1_1&quot;:2828403648,
                &quot;Date_-1&quot;:2769855424
            },
            &quot;ok&quot;:1
        },
        &quot;shard0002&quot;:{
            &quot;ns&quot;:&quot;testdb.test&quot;,
            &quot;count&quot;:69845803,
            &quot;size&quot;:71522102352,
            &quot;avgObjSize&quot;:1024.00000114538,
            &quot;storageSize&quot;:74154252592,
            &quot;numExtents&quot;:65,
            &quot;nindexes&quot;:4,
            &quot;lastExtentSize&quot;:2146426864,
            &quot;paddingFactor&quot;:1,
            &quot;flags&quot;:1,
            &quot;totalIndexSize&quot;:11300515584,
            &quot;indexSizes&quot;:{
                &quot;_id_&quot;:2930942912,
                &quot;Number_1&quot;:2835243968,
                &quot;Number1_1&quot;:2835907520,
                &quot;Date_-1&quot;:2698421184
            },
            &quot;ok&quot;:1
        }
    },
    &quot;ok&quot;:1
}
</code></pre><p>  虽然在最后由于时间的关系，没有测到10亿级别的数据量，但是通过这些数据已经可以证明Mongodb的性能是多么强劲了。另外一个原因是，在很多时候可能数据只达到千万我们就会对库进行拆分，不会让一个库的索引非常庞大。在测试的过程中还发现几个问题需要值得注意： 1） 在数据量很大的情况下，对服务进行重启，那么服务启动的初始化阶段，虽然可以接受数据的查询和修改，但是此时性能很差，因为mongodb会不断把数据从磁盘换入内存，此时的IO压力非常大。 2） 在数据量很大的情况下，如果服务没有正常关闭，那么Mongodb启动修复数据库的时间非常可观，在1.8中退出的-dur貌似可以解决这个问题，据官方说对读取没影响，写入速度会稍稍降低，有空我也会再进行下测试。 3） 在使用Sharding的时候，Mongodb时不时会对数据拆分搬迁，这个时候性能下降很厉害，虽然从测试图中看不出（因为我每一次测试都会测试比较多的迭代次数），但是我在实际观察中可以发现，在搬迁数据的时候每秒插入性能可能会低到几百条。其实我觉得能手动切分数据库就手动切分或者手动做历史库，不要依赖这种自动化的Sharding，因为一开始数据就放到正确的位置比分隔再搬迁效率不知道高多少。个人认为Mongodb单数据库存储不超过1亿的数据比较合适，再大还是手动分库吧。 4） 对于数据的插入，如果使用多线程并不会带来性能的提高，反而还会下降一点性能（并且可以在http接口上看到，有大量的线程处于等待）。 5） 在整个测试过程中，批量插入的时候遇到过几次连接被远程计算机关闭的错误，怀疑是有的时候Mongodb不稳定关闭了连接，或是官方的C#客户端有BUG，但是也仅仅是在数据量特别大的时候遇到几次。</p>
<hr>
<p>最新补充：在之后我又进行了几天测试，把测试数据量进一步加大到5亿，总磁盘占用超过500G，发现和2亿数据量相比，所有性能都差不多，只是测试6和测试7在超过2亿级别数据之后，每400万记录作为一个循环，上下波动30%的性能，非常有规律。 文章来源： <a href="http://www.taocms.org/435.html" target="_blank" rel="noopener">http://www.taocms.org/435.html</a></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/数据库/">数据库</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mongodb/">Mongodb</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/海量数据/">海量数据</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-php-tips" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/12/php-tips/">PHP Tips</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2017/04/12/php-tips/" class="article-date">
	  <time datetime="2017-04-12T01:37:05.000Z" itemprop="datePublished">四月 12, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="php中实现后台执行的方法："><a href="#php中实现后台执行的方法：" class="headerlink" title="php中实现后台执行的方法："></a>php中实现后台执行的方法：</h4><pre><code>ignore_user_abort(true); // 后台运行
set_time_limit(0); // 取消脚本运行时间的超时上限
</code></pre><hr>
<h4 id="PHP-连接-RedisServer-时提示-Message-Redis-connect-connect-failed-Permission-denied"><a href="#PHP-连接-RedisServer-时提示-Message-Redis-connect-connect-failed-Permission-denied" class="headerlink" title="PHP 连接 RedisServer 时提示 Message: Redis::connect(): connect() failed: Permission denied"></a>PHP 连接 RedisServer 时提示 <code>Message: Redis::connect(): connect() failed: Permission denied</code></h4><p>第一次出现是连接远程的 Redis 服务器。之后尝试在本地也安装了一个 redis-server，然后手动启动，并连接——错误依旧 <strong>解决方法：</strong> 首先保证当前服务器已经安装了与当前执行的 PHP 版本对应的 Redis 扩展 然后到命令行执行：</p>
<pre><code>/usr/sbin/setsebool httpd_can_network_connect=1
</code></pre><p>参考来源： <a href="http://stackoverflow.com/questions/8765848/troubleshooting-permission-denied-when-attempting-to-connect-to-redis-from-php" target="_blank" rel="noopener">http://stackoverflow.com/questions/8765848/troubleshooting-permission-denied-when-attempting-to-connect-to-redis-from-php</a></p>
<hr>
<h4 id="PHP-生成随机不可逆字符"><a href="#PHP-生成随机不可逆字符" class="headerlink" title="PHP 生成随机不可逆字符"></a>PHP 生成随机不可逆字符</h4><p>比如用作抵御csrf攻击的token</p>
<pre><code>// 命令行执行即可看到结果
php -r &quot;echo sha1(uniqid(rand(), true));&quot;
</code></pre>
      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/技术分类/">技术分类</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  
    <article id="post-php-socket-error-too-many-open-files" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/03/31/php-socket-error-too-many-open-files/">PHP 运行socket 时报错 too many open files的解决</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2017/03/31/php-socket-error-too-many-open-files/" class="article-date">
	  <time datetime="2017-03-31T04:14:17.000Z" itemprop="datePublished">三月 31, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="PHP-运行socket-时报错-too-many-open-files的解决"><a href="#PHP-运行socket-时报错-too-many-open-files的解决" class="headerlink" title="PHP 运行socket 时报错 too many open files的解决"></a>PHP 运行socket 时报错 too many open files的解决</h2><p>我用socket保存数据流为本地文件，然后向数据库追加一条记录，并返回给客户端 跑了一段时间之后，socket就挂掉了，并提示 too many open files 之前一直以为是 file_put_contents 函数或者socket未合理关闭导致的，结果查了好久也没找到原因，有不少网友说可以加大 ulimit 的句柄数（linux 下输入： ulimit -n 就可以看到当前系统的默认允许句柄大小，默认1024），但是个人觉得这个治标不治本。后来也尝试了，不解决问题，因为我传输的文件有数千万张。。。 后来发现，有可能是mysql 的问题，解决顺序如下： 使用</p>
<pre><code>lsof -n |awk &apos;{print $2}&apos;|sort|uniq -c |sort -nr|more
</code></pre><p>命令可以查看系统中不同程序占用的句柄数，<strong>lsof</strong> 可能系统中默认没有安装，需要手动 install 一下 然后可以看到的结果类似下面这样： <img src="https://tech.msla.top/wp-content/uploads/2018/04/20170331_001_ebe2.png" alt=""> 第一列表示的是打开的句柄数，第二列是对应的进程ID 之后使用</p>
<pre><code>ps -ef | grep [进程ID]
</code></pre><p>就可以看到哪个程序在大量占用句柄</p>
<p> 然后，我发现我的是 mysql …弱智错误 —— PDO没有即使关闭。。<br>因为平时写的程序都是非持续性运行的，PDO在PHP脚本执行完之后自动关闭， </p>
<p>但是这个 <code>listen server</code> 是不断打开、写入的，需要手动关闭<br><a href="http://php.net/manual/zh/pdo.connections.php" target="_blank" rel="noopener">官方文档</a>说，<br><code>$pdo=null</code><br> 就可以了。。  </p>
<hr>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/技术分类/">技术分类</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/socket/">socket</a></li></ul>

      
            
      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

    

  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/10/">Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><a class="page-number" href="/page/13/">13</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/12/">Next</a>
  </nav>

</section>
          <aside id="sidebar">
  
    <div class="widget-wrap" style="margin: 20px 0;">
	<div id="search-form-wrap">

    <form class="search-form">
        <label style="width: 75%;">
            <span class="screen-reader-text">Search for:</span>
            <input type="search" class="search-field" style="height: 42px;" placeholder=" Search…" value="" name="s" title="Search for:">
        </label>
        <input type="submit" class="search-form-submit" value="Search">
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something...">
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
</div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Connect With Us</h3>
    <div class="widget widget_athemes_social_icons">

    	<ul class="clearfix widget-social-icons">   
    	
          
     			  <li><a href="" title="Github"><i class="fa fa-github" aria-hidden="true"></i></a></li> 
          
   		
          
     			  <li><a href="" title="Weibo"><i class="fa fa-weibo" aria-hidden="true"></i></a></li> 
          
   		
          
     			  <li><a href="" title="Twitter"><i class="fa fa-twitter" aria-hidden="true"></i></a></li> 
          
   		
          
     			  <li><a href="" title="Facebook"><i class="fa fa-facebook" aria-hidden="true"></i></a></li> 
          
   		
          
     			  <li><a href="" title="Google-plus"><i class="fa fa-google-plus" aria-hidden="true"></i></a></li> 
          
   		
          
     			  <li><a href="" title="Instagram"><i class="fa fa-instagram" aria-hidden="true"></i></a></li> 
          
   		
          
     			  <li><a href="" title="Pinterest"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li> 
          
   		
          
     			  <li><a href="" title="Flickr"><i class="fa fa-flickr" aria-hidden="true"></i></a></li> 
          
   		
          
            <li><a href="mailto:?subject=请联系我&body=我能帮你什么" title="email"><i class="fa fa-envelope" aria-hidden="true"></i></a></li> 
          
   		
   		</ul>


   		<!--
   		<ul class="clearfix widget-social-icons">   		
   		<li class="widget-si-twitter"><a href="http://twitter.com" title="Twitter"><i class="ico-twitter"></i></a></li> 
		<li class="widget-si-facebook"><a href="http://facebook.com" title="Facebook"><i class="ico-facebook"></i></a></li>
			<li class="widget-si-gplus"><a href="http://plus.google.com" title="Google+"><i class="ico-gplus"></i></a></li>
			<li class="widget-si-pinterest"><a href="http://pinterest.com" title="Pinterest"><i class="ico-pinterest"></i></a></li>
			<li class="widget-si-flickr"><a href="http://flickr.com" title="Flickr"><i class="ico-flickr"></i></a></li>
			<li class="widget-si-instagram"><a href="http://instagram.com" title="Instagram"><i class="ico-instagram"></i></a></li>
		</ul> -->

    </div>
  </div>


  
    
  <div class="widget_athemes_tabs">
    <ul id="widget-tab" class="clearfix widget-tab-nav">
      <li class="active"><a>Recent Posts</a></li>
    </ul>
    <div class="widget">
      <ul>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2018/12/17/exception-memo-in-java/">Java 异常处理的误区和经验总结</a></h6>
              <span>十二月 17, 2018</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2018/12/17/check-some-clouds-disk-speed-on-linux/">各平台主机 IO 速度测试</a></h6>
              <span>十二月 17, 2018</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2018/11/30/linux-e6-89-b9-e9-87-8f-e6-9b-bf-e6-8d-a2-e6-96-87-e4-bb-b6-e5-86-85-e5-ae-b9/">linux批量替换文件内容</a></h6>
              <span>十一月 30, 2018</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2018/08/24/e6-88-91-e6-8e-a8-e8-8d-90-e7-a6-81-e7-94-a8-e7-9a-84-php-e5-87-bd-e6-95-b0/">我推荐禁用的 PHP 函数</a></h6>
              <span>八月 24, 2018</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2018/08/09/mysql-e4-b8-ad-e5-88-a0-e9-99-a4-e9-87-8d-e5-a4-8d-e6-95-b0-e6-8d-ae/">mysql 中删除重复数据</a></h6>
              <span>八月 9, 2018</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2018/08/09/e4-b8-80-e8-a1-8c-e5-91-bd-e4-bb-a4-e5-88-a0-e9-99-a4-e6-96-87-e4-bb-b6-e4-b8-ad-e7-9a-84-e7-a9-ba-e8-a1-8c/">一行命令删除文件中的空行</a></h6>
              <span>八月 9, 2018</span>
            </div>

          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/互联网/">互联网</a><span class="category-list-count">6</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/互联网/操作系统/">操作系统</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/大前端！/">大前端！</a><span class="category-list-count">12</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/大前端！/技术分类/">技术分类</a><span class="category-list-count">9</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术分类/">技术分类</a><span class="category-list-count">120</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/技术分类/操作系统/">操作系统</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术分类/数据库/">数据库</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/操作系统/">操作系统</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a><span class="category-list-count">13</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/AES/" style="font-size: 10px;">AES</a> <a href="/tags/ActiveMQ/" style="font-size: 10.91px;">ActiveMQ</a> <a href="/tags/CodeIginter/" style="font-size: 11.82px;">CodeIginter</a> <a href="/tags/CodeIgniter/" style="font-size: 10px;">CodeIgniter</a> <a href="/tags/GlusterFS/" style="font-size: 10px;">GlusterFS</a> <a href="/tags/Mongodb/" style="font-size: 10px;">Mongodb</a> <a href="/tags/NAT/" style="font-size: 10px;">NAT</a> <a href="/tags/PHP/" style="font-size: 20px;">PHP</a> <a href="/tags/SMTP/" style="font-size: 10px;">SMTP</a> <a href="/tags/Sentry/" style="font-size: 10px;">Sentry</a> <a href="/tags/Two-factor-authentication/" style="font-size: 10px;">Two-factor authentication</a> <a href="/tags/T型累加/" style="font-size: 10px;">T型累加</a> <a href="/tags/VMware/" style="font-size: 10.91px;">VMware</a> <a href="/tags/anyconnect/" style="font-size: 12.73px;">anyconnect</a> <a href="/tags/asp-net/" style="font-size: 14.55px;">asp.net</a> <a href="/tags/backup/" style="font-size: 10px;">backup</a> <a href="/tags/berkeleydb/" style="font-size: 10px;">berkeleydb</a> <a href="/tags/bitcoin/" style="font-size: 10px;">bitcoin</a> <a href="/tags/byte/" style="font-size: 10px;">byte</a> <a href="/tags/c/" style="font-size: 12.73px;">c#</a> <a href="/tags/centos/" style="font-size: 16.36px;">centos</a> <a href="/tags/checkbox/" style="font-size: 10px;">checkbox</a> <a href="/tags/chrome/" style="font-size: 10px;">chrome</a> <a href="/tags/ci/" style="font-size: 10.91px;">ci</a> <a href="/tags/cisco/" style="font-size: 11.82px;">cisco</a> <a href="/tags/combobox/" style="font-size: 10px;">combobox</a> <a href="/tags/datagrid/" style="font-size: 11.82px;">datagrid</a> <a href="/tags/date/" style="font-size: 10px;">date</a> <a href="/tags/dbd/" style="font-size: 10px;">dbd</a> <a href="/tags/debian/" style="font-size: 10.91px;">debian</a> <a href="/tags/debug/" style="font-size: 10.91px;">debug</a> <a href="/tags/desktop/" style="font-size: 10px;">desktop</a> <a href="/tags/dhcp/" style="font-size: 10px;">dhcp</a> <a href="/tags/dropbox/" style="font-size: 10px;">dropbox</a> <a href="/tags/drupal/" style="font-size: 10px;">drupal</a> <a href="/tags/dynamic/" style="font-size: 10px;">dynamic</a> <a href="/tags/easyui/" style="font-size: 15.45px;">easyui</a> <a href="/tags/eclipse/" style="font-size: 10px;">eclipse</a> <a href="/tags/ef/" style="font-size: 10px;">ef</a> <a href="/tags/emacs/" style="font-size: 15.45px;">emacs</a> <a href="/tags/email/" style="font-size: 10px;">email</a> <a href="/tags/entity-framework/" style="font-size: 10px;">entity framework</a> <a href="/tags/excel/" style="font-size: 10px;">excel</a> <a href="/tags/exception/" style="font-size: 10.91px;">exception</a> <a href="/tags/fastdfs/" style="font-size: 13.64px;">fastdfs</a> <a href="/tags/final/" style="font-size: 10px;">final</a> <a href="/tags/fonts/" style="font-size: 10px;">fonts</a> <a href="/tags/freebsd/" style="font-size: 10px;">freebsd</a> <a href="/tags/get/" style="font-size: 10px;">get</a> <a href="/tags/get-result/" style="font-size: 10px;">get_result</a> <a href="/tags/getclass/" style="font-size: 10px;">getclass</a> <a href="/tags/gmail/" style="font-size: 10px;">gmail</a> <a href="/tags/google/" style="font-size: 10.91px;">google</a> <a href="/tags/grep/" style="font-size: 10px;">grep</a> <a href="/tags/gridview/" style="font-size: 10px;">gridview</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/https/" style="font-size: 10.91px;">https</a> <a href="/tags/inputstream/" style="font-size: 10px;">inputstream</a> <a href="/tags/ip/" style="font-size: 10px;">ip</a> <a href="/tags/iptables/" style="font-size: 10px;">iptables</a> <a href="/tags/java/" style="font-size: 18.18px;">java</a> <a href="/tags/javascript/" style="font-size: 13.64px;">javascript</a> <a href="/tags/jdk/" style="font-size: 10px;">jdk</a> <a href="/tags/jms/" style="font-size: 10px;">jms</a> <a href="/tags/jquery/" style="font-size: 12.73px;">jquery</a> <a href="/tags/json/" style="font-size: 10px;">json</a> <a href="/tags/kafka/" style="font-size: 10px;">kafka</a> <a href="/tags/kernel-version/" style="font-size: 10px;">kernel version</a> <a href="/tags/laravel/" style="font-size: 10px;">laravel</a> <a href="/tags/linux/" style="font-size: 19.09px;">linux</a> <a href="/tags/listview/" style="font-size: 10px;">listview</a> <a href="/tags/log4j/" style="font-size: 10px;">log4j</a> <a href="/tags/lvm/" style="font-size: 10px;">lvm</a> <a href="/tags/lxde/" style="font-size: 10px;">lxde</a> <a href="/tags/mailer/" style="font-size: 10px;">mailer</a> <a href="/tags/mariadb/" style="font-size: 10px;">mariadb</a> <a href="/tags/message/" style="font-size: 10px;">message</a> <a href="/tags/microtime/" style="font-size: 10px;">microtime</a> <a href="/tags/monaco/" style="font-size: 10px;">monaco</a> <a href="/tags/mysql/" style="font-size: 17.27px;">mysql</a> <a href="/tags/mysql-load-data/" style="font-size: 10px;">mysql load data</a> <a href="/tags/mysqldump/" style="font-size: 10px;">mysqldump</a> <a href="/tags/netbeans/" style="font-size: 10px;">netbeans</a> <a href="/tags/nginx/" style="font-size: 16.36px;">nginx</a> <a href="/tags/ocserv/" style="font-size: 10px;">ocserv</a> <a href="/tags/openssl/" style="font-size: 10px;">openssl</a> <a href="/tags/openvpn/" style="font-size: 10px;">openvpn</a> <a href="/tags/oss/" style="font-size: 10px;">oss</a> <a href="/tags/owncloud/" style="font-size: 11.82px;">owncloud</a> <a href="/tags/php/" style="font-size: 10px;">php</a> <a href="/tags/phpinfo/" style="font-size: 10px;">phpinfo</a> <a href="/tags/pip/" style="font-size: 10.91px;">pip</a> <a href="/tags/post/" style="font-size: 10.91px;">post</a> <a href="/tags/program/" style="font-size: 10px;">program</a> <a href="/tags/proxy/" style="font-size: 10.91px;">proxy</a> <a href="/tags/python/" style="font-size: 11.82px;">python</a> <a href="/tags/python-pip/" style="font-size: 10.91px;">python-pip</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/redmine/" style="font-size: 10.91px;">redmine</a> <a href="/tags/root/" style="font-size: 10px;">root</a> <a href="/tags/screen/" style="font-size: 10px;">screen</a> <a href="/tags/sed/" style="font-size: 10px;">sed</a> <a href="/tags/shadowsocks/" style="font-size: 11.82px;">shadowsocks</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/slackware/" style="font-size: 10px;">slackware</a> <a href="/tags/sleep/" style="font-size: 10px;">sleep</a> <a href="/tags/socket/" style="font-size: 13.64px;">socket</a> <a href="/tags/sprintboot/" style="font-size: 10px;">sprintboot</a> <a href="/tags/sql/" style="font-size: 10px;">sql</a> <a href="/tags/sqlite/" style="font-size: 10px;">sqlite</a> <a href="/tags/ssh/" style="font-size: 10px;">ssh</a> <a href="/tags/ssl/" style="font-size: 10px;">ssl</a> <a href="/tags/static/" style="font-size: 10px;">static</a> <a href="/tags/symfony/" style="font-size: 10.91px;">symfony</a> <a href="/tags/tar/" style="font-size: 10px;">tar</a> <a href="/tags/terminal/" style="font-size: 10px;">terminal</a> <a href="/tags/time/" style="font-size: 10.91px;">time</a> <a href="/tags/timestamp/" style="font-size: 10px;">timestamp</a> <a href="/tags/ubuntu/" style="font-size: 11.82px;">ubuntu</a> <a href="/tags/usort/" style="font-size: 10px;">usort</a> <a href="/tags/vim/" style="font-size: 15.45px;">vim</a> <a href="/tags/virutal-box/" style="font-size: 10px;">virutal box</a> <a href="/tags/vpn/" style="font-size: 10.91px;">vpn</a> <a href="/tags/vpn868错误/" style="font-size: 10px;">vpn868错误</a> <a href="/tags/wifi/" style="font-size: 10.91px;">wifi</a> <a href="/tags/wordpress/" style="font-size: 10.91px;">wordpress</a> <a href="/tags/xfce/" style="font-size: 10px;">xfce</a> <a href="/tags/yaf/" style="font-size: 10.91px;">yaf</a> <a href="/tags/yotube/" style="font-size: 10px;">yotube</a> <a href="/tags/上古卷轴5/" style="font-size: 10px;">上古卷轴5</a> <a href="/tags/两步验证/" style="font-size: 10px;">两步验证</a> <a href="/tags/中科大/" style="font-size: 10px;">中科大</a> <a href="/tags/代理/" style="font-size: 13.64px;">代理</a> <a href="/tags/优化/" style="font-size: 10px;">优化</a> <a href="/tags/依赖注入/" style="font-size: 10px;">依赖注入</a> <a href="/tags/保存/" style="font-size: 10px;">保存</a> <a href="/tags/修改密码/" style="font-size: 10px;">修改密码</a> <a href="/tags/关闭/" style="font-size: 10px;">关闭</a> <a href="/tags/写文件/" style="font-size: 10px;">写文件</a> <a href="/tags/分级/" style="font-size: 10px;">分级</a> <a href="/tags/分页/" style="font-size: 10px;">分页</a> <a href="/tags/创建用户/" style="font-size: 10px;">创建用户</a> <a href="/tags/删除/" style="font-size: 10px;">删除</a> <a href="/tags/刷新/" style="font-size: 10px;">刷新</a> <a href="/tags/动态类型/" style="font-size: 10px;">动态类型</a> <a href="/tags/华为/" style="font-size: 10px;">华为</a> <a href="/tags/卡夫卡/" style="font-size: 10px;">卡夫卡</a> <a href="/tags/参数化/" style="font-size: 10.91px;">参数化</a> <a href="/tags/参数化查询/" style="font-size: 10px;">参数化查询</a> <a href="/tags/后台/" style="font-size: 10px;">后台</a> <a href="/tags/命令/" style="font-size: 10.91px;">命令</a> <a href="/tags/命令行/" style="font-size: 10.91px;">命令行</a> <a href="/tags/备份/" style="font-size: 10px;">备份</a> <a href="/tags/复选框/" style="font-size: 10px;">复选框</a> <a href="/tags/子部门/" style="font-size: 10px;">子部门</a> <a href="/tags/字符串/" style="font-size: 10px;">字符串</a> <a href="/tags/字节流/" style="font-size: 10.91px;">字节流</a> <a href="/tags/宏/" style="font-size: 10px;">宏</a> <a href="/tags/对称加密/" style="font-size: 10px;">对称加密</a> <a href="/tags/工厂模式/" style="font-size: 10px;">工厂模式</a> <a href="/tags/开发环境/" style="font-size: 10px;">开发环境</a> <a href="/tags/异常/" style="font-size: 11.82px;">异常</a> <a href="/tags/微信/" style="font-size: 10px;">微信</a> <a href="/tags/微软雅黑/" style="font-size: 10px;">微软雅黑</a> <a href="/tags/德兰修女/" style="font-size: 10px;">德兰修女</a> <a href="/tags/思科/" style="font-size: 10px;">思科</a> <a href="/tags/性能/" style="font-size: 10px;">性能</a> <a href="/tags/手机/" style="font-size: 10px;">手机</a> <a href="/tags/执行时间/" style="font-size: 10px;">执行时间</a> <a href="/tags/挖矿/" style="font-size: 10px;">挖矿</a> <a href="/tags/排序/" style="font-size: 10px;">排序</a> <a href="/tags/提交/" style="font-size: 10px;">提交</a> <a href="/tags/敏捷/" style="font-size: 10px;">敏捷</a> <a href="/tags/数据备份/" style="font-size: 10px;">数据备份</a> <a href="/tags/数据库/" style="font-size: 11.82px;">数据库</a> <a href="/tags/数组/" style="font-size: 10.91px;">数组</a> <a href="/tags/文件存储/" style="font-size: 10px;">文件存储</a> <a href="/tags/文件操作/" style="font-size: 10px;">文件操作</a> <a href="/tags/日志/" style="font-size: 10px;">日志</a> <a href="/tags/日期时间/" style="font-size: 10px;">日期时间</a> <a href="/tags/时间/" style="font-size: 10px;">时间</a> <a href="/tags/时间戳/" style="font-size: 10px;">时间戳</a> <a href="/tags/替换/" style="font-size: 11.82px;">替换</a> <a href="/tags/枚举/" style="font-size: 10px;">枚举</a> <a href="/tags/架构/" style="font-size: 10px;">架构</a> <a href="/tags/架构师/" style="font-size: 10px;">架构师</a> <a href="/tags/树莓派/" style="font-size: 10.91px;">树莓派</a> <a href="/tags/框架/" style="font-size: 10px;">框架</a> <a href="/tags/比特币/" style="font-size: 10px;">比特币</a> <a href="/tags/毫秒/" style="font-size: 10px;">毫秒</a> <a href="/tags/浏览器/" style="font-size: 10px;">浏览器</a> <a href="/tags/海量数据/" style="font-size: 10px;">海量数据</a> <a href="/tags/海量数据导入/" style="font-size: 10px;">海量数据导入</a> <a href="/tags/消息/" style="font-size: 10.91px;">消息</a> <a href="/tags/消息队列/" style="font-size: 10px;">消息队列</a> <a href="/tags/环境配置/" style="font-size: 10px;">环境配置</a> <a href="/tags/用户/" style="font-size: 10px;">用户</a> <a href="/tags/箴言/" style="font-size: 10px;">箴言</a> <a href="/tags/索引/" style="font-size: 10px;">索引</a> <a href="/tags/累加/" style="font-size: 10px;">累加</a> <a href="/tags/组/" style="font-size: 10px;">组</a> <a href="/tags/终端/" style="font-size: 11.82px;">终端</a> <a href="/tags/缓冲区/" style="font-size: 10px;">缓冲区</a> <a href="/tags/网络/" style="font-size: 10.91px;">网络</a> <a href="/tags/自定义函数/" style="font-size: 10px;">自定义函数</a> <a href="/tags/虚拟机/" style="font-size: 10.91px;">虚拟机</a> <a href="/tags/解锁/" style="font-size: 10px;">解锁</a> <a href="/tags/设计模式/" style="font-size: 10px;">设计模式</a> <a href="/tags/调试/" style="font-size: 10.91px;">调试</a> <a href="/tags/转换/" style="font-size: 10.91px;">转换</a> <a href="/tags/输入法/" style="font-size: 10px;">输入法</a> <a href="/tags/追加/" style="font-size: 10px;">追加</a> <a href="/tags/逆向工程/" style="font-size: 10px;">逆向工程</a> <a href="/tags/邮件/" style="font-size: 11.82px;">邮件</a> <a href="/tags/邮箱/" style="font-size: 10.91px;">邮箱</a> <a href="/tags/防火墙/" style="font-size: 10px;">防火墙</a> <a href="/tags/阿里云/" style="font-size: 10.91px;">阿里云</a> <a href="/tags/随机数/" style="font-size: 10px;">随机数</a> <a href="/tags/默认路径/" style="font-size: 10px;">默认路径</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>

    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a><span class="archive-list-count">17</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a><span class="archive-list-count">20</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">四月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">三月 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">十二月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">十一月 2014</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2018 Technician All Rights Reserved.
          
            <span id="busuanzi_container_site_uv">
              本站访客数<span id="busuanzi_value_site_uv"></span>人次  
              本站总访问量<span id="busuanzi_value_site_pv"></span>次
            </span>
          
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hiero" target="_blank">hiero</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var contentdiv = document.getElementById("content");

    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
</script>

<!-- Custome JS -->
<script src="/js/my.js"></script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>


<script src="/js/scripts.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>








	<script async src="https://dnqof95d40fo6.cloudfront.net/atw7f8.js">
	</script>






  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
</body>
</html>
